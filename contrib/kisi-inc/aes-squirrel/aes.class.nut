/*
 * This file is part of aes-squirrel.
 *
 * Based on aes-js: https://github.com/ricmoo/aes-js
 *
 * (c) 2015 Richard Moore
 * (c) 2016 KISI Inc.
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

/**
 * Convert the raw string to an array of 8-bit integers.
 */
function rawToByteArray(str)
{
  local arr = array(str.len());
  for (local i = 0; i < str.len(); ++i)
    arr[i] = str[i] & 0xff;

  return arr;
}

/**
 * Convert the raw string to an array of 32-bit integers.
 */
function rawToIntArray(str)
{
  local arr = array(str.len() / 4);
  local j = 0;
  for (local i = 0; i < str.len(); i += 4)
    arr[j++] = ((str[i + 0] & 0xff) << 24) |
               ((str[i + 1] & 0xff) << 16) |
               ((str[i + 2] & 0xff) << 8) |
               (str[i + 3] & 0xff);

  return arr;
}

class AES {

  // Number of rounds by keysize
  static numberOfRounds = { "16": 10, "24": 12, "32": 14 }

  // Note: To use less program space, store raw strings and convert to arrays.
  // Round constant words
  static rcon = rawToByteArray("\x01\x02\x04\x08\x10\x20\x40\x80\x1b\x36\x6c\xd8\xab\x4d\x9a\x2f\x5e\xbc\x63\xc6\x97\x35\x6a\xd4\xb3\x7d\xfa\xef\xc5\x91");

  // S-box and Inverse S-box (S is for Substitution)
  static S = rawToByteArray("\x63\x7c\x77\x7b\xf2\x6b\x6f\xc5\x30\x01\x67\x2b\xfe\xd7\xab\x76\xca\x82\xc9\x7d\xfa\x59\x47\xf0\xad\xd4\xa2\xaf\x9c\xa4\x72\xc0\xb7\xfd\x93\x26\x36\x3f\xf7\xcc\x34\xa5\xe5\xf1\x71\xd8\x31\x15\x04\xc7\x23\xc3\x18\x96\x05\x9a\x07\x12\x80\xe2\xeb\x27\xb2\x75\x09\x83\x2c\x1a\x1b\x6e\x5a\xa0\x52\x3b\xd6\xb3\x29\xe3\x2f\x84\x53\xd1\x00\xed\x20\xfc\xb1\x5b\x6a\xcb\xbe\x39\x4a\x4c\x58\xcf\xd0\xef\xaa\xfb\x43\x4d\x33\x85\x45\xf9\x02\x7f\x50\x3c\x9f\xa8\x51\xa3\x40\x8f\x92\x9d\x38\xf5\xbc\xb6\xda\x21\x10\xff\xf3\xd2\xcd\x0c\x13\xec\x5f\x97\x44\x17\xc4\xa7\x7e\x3d\x64\x5d\x19\x73\x60\x81\x4f\xdc\x22\x2a\x90\x88\x46\xee\xb8\x14\xde\x5e\x0b\xdb\xe0\x32\x3a\x0a\x49\x06\x24\x5c\xc2\xd3\xac\x62\x91\x95\xe4\x79\xe7\xc8\x37\x6d\x8d\xd5\x4e\xa9\x6c\x56\xf4\xea\x65\x7a\xae\x08\xba\x78\x25\x2e\x1c\xa6\xb4\xc6\xe8\xdd\x74\x1f\x4b\xbd\x8b\x8a\x70\x3e\xb5\x66\x48\x03\xf6\x0e\x61\x35\x57\xb9\x86\xc1\x1d\x9e\xe1\xf8\x98\x11\x69\xd9\x8e\x94\x9b\x1e\x87\xe9\xce\x55\x28\xdf\x8c\xa1\x89\x0d\xbf\xe6\x42\x68\x41\x99\x2d\x0f\xb0\x54\xbb\x16");
  static Si =rawToByteArray("\x52\x09\x6a\xd5\x30\x36\xa5\x38\xbf\x40\xa3\x9e\x81\xf3\xd7\xfb\x7c\xe3\x39\x82\x9b\x2f\xff\x87\x34\x8e\x43\x44\xc4\xde\xe9\xcb\x54\x7b\x94\x32\xa6\xc2\x23\x3d\xee\x4c\x95\x0b\x42\xfa\xc3\x4e\x08\x2e\xa1\x66\x28\xd9\x24\xb2\x76\x5b\xa2\x49\x6d\x8b\xd1\x25\x72\xf8\xf6\x64\x86\x68\x98\x16\xd4\xa4\x5c\xcc\x5d\x65\xb6\x92\x6c\x70\x48\x50\xfd\xed\xb9\xda\x5e\x15\x46\x57\xa7\x8d\x9d\x84\x90\xd8\xab\x00\x8c\xbc\xd3\x0a\xf7\xe4\x58\x05\xb8\xb3\x45\x06\xd0\x2c\x1e\x8f\xca\x3f\x0f\x02\xc1\xaf\xbd\x03\x01\x13\x8a\x6b\x3a\x91\x11\x41\x4f\x67\xdc\xea\x97\xf2\xcf\xce\xf0\xb4\xe6\x73\x96\xac\x74\x22\xe7\xad\x35\x85\xe2\xf9\x37\xe8\x1c\x75\xdf\x6e\x47\xf1\x1a\x71\x1d\x29\xc5\x89\x6f\xb7\x62\x0e\xaa\x18\xbe\x1b\xfc\x56\x3e\x4b\xc6\xd2\x79\x20\x9a\xdb\xc0\xfe\x78\xcd\x5a\xf4\x1f\xdd\xa8\x33\x88\x07\xc7\x31\xb1\x12\x10\x59\x27\x80\xec\x5f\x60\x51\x7f\xa9\x19\xb5\x4a\x0d\x2d\xe5\x7a\x9f\x93\xc9\x9c\xef\xa0\xe0\x3b\x4d\xae\x2a\xf5\xb0\xc8\xeb\xbb\x3c\x83\x53\x99\x61\x17\x2b\x04\x7e\xba\x77\xd6\x26\xe1\x69\x14\x63\x55\x21\x0c\x7d");

  // Transformations for encryption
  static T1 = rawToIntArray("\xc6\x63\x63\xa5\xf8\x7c\x7c\x84\xee\x77\x77\x99\xf6\x7b\x7b\x8d\xff\xf2\xf2\x0d\xd6\x6b\x6b\xbd\xde\x6f\x6f\xb1\x91\xc5\xc5\x54\x60\x30\x30\x50\x02\x01\x01\x03\xce\x67\x67\xa9\x56\x2b\x2b\x7d\xe7\xfe\xfe\x19\xb5\xd7\xd7\x62\x4d\xab\xab\xe6\xec\x76\x76\x9a\x8f\xca\xca\x45\x1f\x82\x82\x9d\x89\xc9\xc9\x40\xfa\x7d\x7d\x87\xef\xfa\xfa\x15\xb2\x59\x59\xeb\x8e\x47\x47\xc9\xfb\xf0\xf0\x0b\x41\xad\xad\xec\xb3\xd4\xd4\x67\x5f\xa2\xa2\xfd\x45\xaf\xaf\xea\x23\x9c\x9c\xbf\x53\xa4\xa4\xf7\xe4\x72\x72\x96\x9b\xc0\xc0\x5b\x75\xb7\xb7\xc2\xe1\xfd\xfd\x1c\x3d\x93\x93\xae\x4c\x26\x26\x6a\x6c\x36\x36\x5a\x7e\x3f\x3f\x41\xf5\xf7\xf7\x02\x83\xcc\xcc\x4f\x68\x34\x34\x5c\x51\xa5\xa5\xf4\xd1\xe5\xe5\x34\xf9\xf1\xf1\x08\xe2\x71\x71\x93\xab\xd8\xd8\x73\x62\x31\x31\x53\x2a\x15\x15\x3f\x08\x04\x04\x0c\x95\xc7\xc7\x52\x46\x23\x23\x65\x9d\xc3\xc3\x5e\x30\x18\x18\x28\x37\x96\x96\xa1\x0a\x05\x05\x0f\x2f\x9a\x9a\xb5\x0e\x07\x07\x09\x24\x12\x12\x36\x1b\x80\x80\x9b\xdf\xe2\xe2\x3d\xcd\xeb\xeb\x26\x4e\x27\x27\x69\x7f\xb2\xb2\xcd\xea\x75\x75\x9f\x12\x09\x09\x1b\x1d\x83\x83\x9e\x58\x2c\x2c\x74\x34\x1a\x1a\x2e\x36\x1b\x1b\x2d\xdc\x6e\x6e\xb2\xb4\x5a\x5a\xee\x5b\xa0\xa0\xfb\xa4\x52\x52\xf6\x76\x3b\x3b\x4d\xb7\xd6\xd6\x61\x7d\xb3\xb3\xce\x52\x29\x29\x7b\xdd\xe3\xe3\x3e\x5e\x2f\x2f\x71\x13\x84\x84\x97\xa6\x53\x53\xf5\xb9\xd1\xd1\x68\x00\x00\x00\x00\xc1\xed\xed\x2c\x40\x20\x20\x60\xe3\xfc\xfc\x1f\x79\xb1\xb1\xc8\xb6\x5b\x5b\xed\xd4\x6a\x6a\xbe\x8d\xcb\xcb\x46\x67\xbe\xbe\xd9\x72\x39\x39\x4b\x94\x4a\x4a\xde\x98\x4c\x4c\xd4\xb0\x58\x58\xe8\x85\xcf\xcf\x4a\xbb\xd0\xd0\x6b\xc5\xef\xef\x2a\x4f\xaa\xaa\xe5\xed\xfb\xfb\x16\x86\x43\x43\xc5\x9a\x4d\x4d\xd7\x66\x33\x33\x55\x11\x85\x85\x94\x8a\x45\x45\xcf\xe9\xf9\xf9\x10\x04\x02\x02\x06\xfe\x7f\x7f\x81\xa0\x50\x50\xf0\x78\x3c\x3c\x44\x25\x9f\x9f\xba\x4b\xa8\xa8\xe3\xa2\x51\x51\xf3\x5d\xa3\xa3\xfe\x80\x40\x40\xc0\x05\x8f\x8f\x8a\x3f\x92\x92\xad\x21\x9d\x9d\xbc\x70\x38\x38\x48\xf1\xf5\xf5\x04\x63\xbc\xbc\xdf\x77\xb6\xb6\xc1\xaf\xda\xda\x75\x42\x21\x21\x63\x20\x10\x10\x30\xe5\xff\xff\x1a\xfd\xf3\xf3\x0e\xbf\xd2\xd2\x6d\x81\xcd\xcd\x4c\x18\x0c\x0c\x14\x26\x13\x13\x35\xc3\xec\xec\x2f\xbe\x5f\x5f\xe1\x35\x97\x97\xa2\x88\x44\x44\xcc\x2e\x17\x17\x39\x93\xc4\xc4\x57\x55\xa7\xa7\xf2\xfc\x7e\x7e\x82\x7a\x3d\x3d\x47\xc8\x64\x64\xac\xba\x5d\x5d\xe7\x32\x19\x19\x2b\xe6\x73\x73\x95\xc0\x60\x60\xa0\x19\x81\x81\x98\x9e\x4f\x4f\xd1\xa3\xdc\xdc\x7f\x44\x22\x22\x66\x54\x2a\x2a\x7e\x3b\x90\x90\xab\x0b\x88\x88\x83\x8c\x46\x46\xca\xc7\xee\xee\x29\x6b\xb8\xb8\xd3\x28\x14\x14\x3c\xa7\xde\xde\x79\xbc\x5e\x5e\xe2\x16\x0b\x0b\x1d\xad\xdb\xdb\x76\xdb\xe0\xe0\x3b\x64\x32\x32\x56\x74\x3a\x3a\x4e\x14\x0a\x0a\x1e\x92\x49\x49\xdb\x0c\x06\x06\x0a\x48\x24\x24\x6c\xb8\x5c\x5c\xe4\x9f\xc2\xc2\x5d\xbd\xd3\xd3\x6e\x43\xac\xac\xef\xc4\x62\x62\xa6\x39\x91\x91\xa8\x31\x95\x95\xa4\xd3\xe4\xe4\x37\xf2\x79\x79\x8b\xd5\xe7\xe7\x32\x8b\xc8\xc8\x43\x6e\x37\x37\x59\xda\x6d\x6d\xb7\x01\x8d\x8d\x8c\xb1\xd5\xd5\x64\x9c\x4e\x4e\xd2\x49\xa9\xa9\xe0\xd8\x6c\x6c\xb4\xac\x56\x56\xfa\xf3\xf4\xf4\x07\xcf\xea\xea\x25\xca\x65\x65\xaf\xf4\x7a\x7a\x8e\x47\xae\xae\xe9\x10\x08\x08\x18\x6f\xba\xba\xd5\xf0\x78\x78\x88\x4a\x25\x25\x6f\x5c\x2e\x2e\x72\x38\x1c\x1c\x24\x57\xa6\xa6\xf1\x73\xb4\xb4\xc7\x97\xc6\xc6\x51\xcb\xe8\xe8\x23\xa1\xdd\xdd\x7c\xe8\x74\x74\x9c\x3e\x1f\x1f\x21\x96\x4b\x4b\xdd\x61\xbd\xbd\xdc\x0d\x8b\x8b\x86\x0f\x8a\x8a\x85\xe0\x70\x70\x90\x7c\x3e\x3e\x42\x71\xb5\xb5\xc4\xcc\x66\x66\xaa\x90\x48\x48\xd8\x06\x03\x03\x05\xf7\xf6\xf6\x01\x1c\x0e\x0e\x12\xc2\x61\x61\xa3\x6a\x35\x35\x5f\xae\x57\x57\xf9\x69\xb9\xb9\xd0\x17\x86\x86\x91\x99\xc1\xc1\x58\x3a\x1d\x1d\x27\x27\x9e\x9e\xb9\xd9\xe1\xe1\x38\xeb\xf8\xf8\x13\x2b\x98\x98\xb3\x22\x11\x11\x33\xd2\x69\x69\xbb\xa9\xd9\xd9\x70\x07\x8e\x8e\x89\x33\x94\x94\xa7\x2d\x9b\x9b\xb6\x3c\x1e\x1e\x22\x15\x87\x87\x92\xc9\xe9\xe9\x20\x87\xce\xce\x49\xaa\x55\x55\xff\x50\x28\x28\x78\xa5\xdf\xdf\x7a\x03\x8c\x8c\x8f\x59\xa1\xa1\xf8\x09\x89\x89\x80\x1a\x0d\x0d\x17\x65\xbf\xbf\xda\xd7\xe6\xe6\x31\x84\x42\x42\xc6\xd0\x68\x68\xb8\x82\x41\x41\xc3\x29\x99\x99\xb0\x5a\x2d\x2d\x77\x1e\x0f\x0f\x11\x7b\xb0\xb0\xcb\xa8\x54\x54\xfc\x6d\xbb\xbb\xd6\x2c\x16\x16\x3a");
  static T2 = rawToIntArray("\xa5\xc6\x63\x63\x84\xf8\x7c\x7c\x99\xee\x77\x77\x8d\xf6\x7b\x7b\x0d\xff\xf2\xf2\xbd\xd6\x6b\x6b\xb1\xde\x6f\x6f\x54\x91\xc5\xc5\x50\x60\x30\x30\x03\x02\x01\x01\xa9\xce\x67\x67\x7d\x56\x2b\x2b\x19\xe7\xfe\xfe\x62\xb5\xd7\xd7\xe6\x4d\xab\xab\x9a\xec\x76\x76\x45\x8f\xca\xca\x9d\x1f\x82\x82\x40\x89\xc9\xc9\x87\xfa\x7d\x7d\x15\xef\xfa\xfa\xeb\xb2\x59\x59\xc9\x8e\x47\x47\x0b\xfb\xf0\xf0\xec\x41\xad\xad\x67\xb3\xd4\xd4\xfd\x5f\xa2\xa2\xea\x45\xaf\xaf\xbf\x23\x9c\x9c\xf7\x53\xa4\xa4\x96\xe4\x72\x72\x5b\x9b\xc0\xc0\xc2\x75\xb7\xb7\x1c\xe1\xfd\xfd\xae\x3d\x93\x93\x6a\x4c\x26\x26\x5a\x6c\x36\x36\x41\x7e\x3f\x3f\x02\xf5\xf7\xf7\x4f\x83\xcc\xcc\x5c\x68\x34\x34\xf4\x51\xa5\xa5\x34\xd1\xe5\xe5\x08\xf9\xf1\xf1\x93\xe2\x71\x71\x73\xab\xd8\xd8\x53\x62\x31\x31\x3f\x2a\x15\x15\x0c\x08\x04\x04\x52\x95\xc7\xc7\x65\x46\x23\x23\x5e\x9d\xc3\xc3\x28\x30\x18\x18\xa1\x37\x96\x96\x0f\x0a\x05\x05\xb5\x2f\x9a\x9a\x09\x0e\x07\x07\x36\x24\x12\x12\x9b\x1b\x80\x80\x3d\xdf\xe2\xe2\x26\xcd\xeb\xeb\x69\x4e\x27\x27\xcd\x7f\xb2\xb2\x9f\xea\x75\x75\x1b\x12\x09\x09\x9e\x1d\x83\x83\x74\x58\x2c\x2c\x2e\x34\x1a\x1a\x2d\x36\x1b\x1b\xb2\xdc\x6e\x6e\xee\xb4\x5a\x5a\xfb\x5b\xa0\xa0\xf6\xa4\x52\x52\x4d\x76\x3b\x3b\x61\xb7\xd6\xd6\xce\x7d\xb3\xb3\x7b\x52\x29\x29\x3e\xdd\xe3\xe3\x71\x5e\x2f\x2f\x97\x13\x84\x84\xf5\xa6\x53\x53\x68\xb9\xd1\xd1\x00\x00\x00\x00\x2c\xc1\xed\xed\x60\x40\x20\x20\x1f\xe3\xfc\xfc\xc8\x79\xb1\xb1\xed\xb6\x5b\x5b\xbe\xd4\x6a\x6a\x46\x8d\xcb\xcb\xd9\x67\xbe\xbe\x4b\x72\x39\x39\xde\x94\x4a\x4a\xd4\x98\x4c\x4c\xe8\xb0\x58\x58\x4a\x85\xcf\xcf\x6b\xbb\xd0\xd0\x2a\xc5\xef\xef\xe5\x4f\xaa\xaa\x16\xed\xfb\xfb\xc5\x86\x43\x43\xd7\x9a\x4d\x4d\x55\x66\x33\x33\x94\x11\x85\x85\xcf\x8a\x45\x45\x10\xe9\xf9\xf9\x06\x04\x02\x02\x81\xfe\x7f\x7f\xf0\xa0\x50\x50\x44\x78\x3c\x3c\xba\x25\x9f\x9f\xe3\x4b\xa8\xa8\xf3\xa2\x51\x51\xfe\x5d\xa3\xa3\xc0\x80\x40\x40\x8a\x05\x8f\x8f\xad\x3f\x92\x92\xbc\x21\x9d\x9d\x48\x70\x38\x38\x04\xf1\xf5\xf5\xdf\x63\xbc\xbc\xc1\x77\xb6\xb6\x75\xaf\xda\xda\x63\x42\x21\x21\x30\x20\x10\x10\x1a\xe5\xff\xff\x0e\xfd\xf3\xf3\x6d\xbf\xd2\xd2\x4c\x81\xcd\xcd\x14\x18\x0c\x0c\x35\x26\x13\x13\x2f\xc3\xec\xec\xe1\xbe\x5f\x5f\xa2\x35\x97\x97\xcc\x88\x44\x44\x39\x2e\x17\x17\x57\x93\xc4\xc4\xf2\x55\xa7\xa7\x82\xfc\x7e\x7e\x47\x7a\x3d\x3d\xac\xc8\x64\x64\xe7\xba\x5d\x5d\x2b\x32\x19\x19\x95\xe6\x73\x73\xa0\xc0\x60\x60\x98\x19\x81\x81\xd1\x9e\x4f\x4f\x7f\xa3\xdc\xdc\x66\x44\x22\x22\x7e\x54\x2a\x2a\xab\x3b\x90\x90\x83\x0b\x88\x88\xca\x8c\x46\x46\x29\xc7\xee\xee\xd3\x6b\xb8\xb8\x3c\x28\x14\x14\x79\xa7\xde\xde\xe2\xbc\x5e\x5e\x1d\x16\x0b\x0b\x76\xad\xdb\xdb\x3b\xdb\xe0\xe0\x56\x64\x32\x32\x4e\x74\x3a\x3a\x1e\x14\x0a\x0a\xdb\x92\x49\x49\x0a\x0c\x06\x06\x6c\x48\x24\x24\xe4\xb8\x5c\x5c\x5d\x9f\xc2\xc2\x6e\xbd\xd3\xd3\xef\x43\xac\xac\xa6\xc4\x62\x62\xa8\x39\x91\x91\xa4\x31\x95\x95\x37\xd3\xe4\xe4\x8b\xf2\x79\x79\x32\xd5\xe7\xe7\x43\x8b\xc8\xc8\x59\x6e\x37\x37\xb7\xda\x6d\x6d\x8c\x01\x8d\x8d\x64\xb1\xd5\xd5\xd2\x9c\x4e\x4e\xe0\x49\xa9\xa9\xb4\xd8\x6c\x6c\xfa\xac\x56\x56\x07\xf3\xf4\xf4\x25\xcf\xea\xea\xaf\xca\x65\x65\x8e\xf4\x7a\x7a\xe9\x47\xae\xae\x18\x10\x08\x08\xd5\x6f\xba\xba\x88\xf0\x78\x78\x6f\x4a\x25\x25\x72\x5c\x2e\x2e\x24\x38\x1c\x1c\xf1\x57\xa6\xa6\xc7\x73\xb4\xb4\x51\x97\xc6\xc6\x23\xcb\xe8\xe8\x7c\xa1\xdd\xdd\x9c\xe8\x74\x74\x21\x3e\x1f\x1f\xdd\x96\x4b\x4b\xdc\x61\xbd\xbd\x86\x0d\x8b\x8b\x85\x0f\x8a\x8a\x90\xe0\x70\x70\x42\x7c\x3e\x3e\xc4\x71\xb5\xb5\xaa\xcc\x66\x66\xd8\x90\x48\x48\x05\x06\x03\x03\x01\xf7\xf6\xf6\x12\x1c\x0e\x0e\xa3\xc2\x61\x61\x5f\x6a\x35\x35\xf9\xae\x57\x57\xd0\x69\xb9\xb9\x91\x17\x86\x86\x58\x99\xc1\xc1\x27\x3a\x1d\x1d\xb9\x27\x9e\x9e\x38\xd9\xe1\xe1\x13\xeb\xf8\xf8\xb3\x2b\x98\x98\x33\x22\x11\x11\xbb\xd2\x69\x69\x70\xa9\xd9\xd9\x89\x07\x8e\x8e\xa7\x33\x94\x94\xb6\x2d\x9b\x9b\x22\x3c\x1e\x1e\x92\x15\x87\x87\x20\xc9\xe9\xe9\x49\x87\xce\xce\xff\xaa\x55\x55\x78\x50\x28\x28\x7a\xa5\xdf\xdf\x8f\x03\x8c\x8c\xf8\x59\xa1\xa1\x80\x09\x89\x89\x17\x1a\x0d\x0d\xda\x65\xbf\xbf\x31\xd7\xe6\xe6\xc6\x84\x42\x42\xb8\xd0\x68\x68\xc3\x82\x41\x41\xb0\x29\x99\x99\x77\x5a\x2d\x2d\x11\x1e\x0f\x0f\xcb\x7b\xb0\xb0\xfc\xa8\x54\x54\xd6\x6d\xbb\xbb\x3a\x2c\x16\x16");
  static T3 = rawToIntArray("\x63\xa5\xc6\x63\x7c\x84\xf8\x7c\x77\x99\xee\x77\x7b\x8d\xf6\x7b\xf2\x0d\xff\xf2\x6b\xbd\xd6\x6b\x6f\xb1\xde\x6f\xc5\x54\x91\xc5\x30\x50\x60\x30\x01\x03\x02\x01\x67\xa9\xce\x67\x2b\x7d\x56\x2b\xfe\x19\xe7\xfe\xd7\x62\xb5\xd7\xab\xe6\x4d\xab\x76\x9a\xec\x76\xca\x45\x8f\xca\x82\x9d\x1f\x82\xc9\x40\x89\xc9\x7d\x87\xfa\x7d\xfa\x15\xef\xfa\x59\xeb\xb2\x59\x47\xc9\x8e\x47\xf0\x0b\xfb\xf0\xad\xec\x41\xad\xd4\x67\xb3\xd4\xa2\xfd\x5f\xa2\xaf\xea\x45\xaf\x9c\xbf\x23\x9c\xa4\xf7\x53\xa4\x72\x96\xe4\x72\xc0\x5b\x9b\xc0\xb7\xc2\x75\xb7\xfd\x1c\xe1\xfd\x93\xae\x3d\x93\x26\x6a\x4c\x26\x36\x5a\x6c\x36\x3f\x41\x7e\x3f\xf7\x02\xf5\xf7\xcc\x4f\x83\xcc\x34\x5c\x68\x34\xa5\xf4\x51\xa5\xe5\x34\xd1\xe5\xf1\x08\xf9\xf1\x71\x93\xe2\x71\xd8\x73\xab\xd8\x31\x53\x62\x31\x15\x3f\x2a\x15\x04\x0c\x08\x04\xc7\x52\x95\xc7\x23\x65\x46\x23\xc3\x5e\x9d\xc3\x18\x28\x30\x18\x96\xa1\x37\x96\x05\x0f\x0a\x05\x9a\xb5\x2f\x9a\x07\x09\x0e\x07\x12\x36\x24\x12\x80\x9b\x1b\x80\xe2\x3d\xdf\xe2\xeb\x26\xcd\xeb\x27\x69\x4e\x27\xb2\xcd\x7f\xb2\x75\x9f\xea\x75\x09\x1b\x12\x09\x83\x9e\x1d\x83\x2c\x74\x58\x2c\x1a\x2e\x34\x1a\x1b\x2d\x36\x1b\x6e\xb2\xdc\x6e\x5a\xee\xb4\x5a\xa0\xfb\x5b\xa0\x52\xf6\xa4\x52\x3b\x4d\x76\x3b\xd6\x61\xb7\xd6\xb3\xce\x7d\xb3\x29\x7b\x52\x29\xe3\x3e\xdd\xe3\x2f\x71\x5e\x2f\x84\x97\x13\x84\x53\xf5\xa6\x53\xd1\x68\xb9\xd1\x00\x00\x00\x00\xed\x2c\xc1\xed\x20\x60\x40\x20\xfc\x1f\xe3\xfc\xb1\xc8\x79\xb1\x5b\xed\xb6\x5b\x6a\xbe\xd4\x6a\xcb\x46\x8d\xcb\xbe\xd9\x67\xbe\x39\x4b\x72\x39\x4a\xde\x94\x4a\x4c\xd4\x98\x4c\x58\xe8\xb0\x58\xcf\x4a\x85\xcf\xd0\x6b\xbb\xd0\xef\x2a\xc5\xef\xaa\xe5\x4f\xaa\xfb\x16\xed\xfb\x43\xc5\x86\x43\x4d\xd7\x9a\x4d\x33\x55\x66\x33\x85\x94\x11\x85\x45\xcf\x8a\x45\xf9\x10\xe9\xf9\x02\x06\x04\x02\x7f\x81\xfe\x7f\x50\xf0\xa0\x50\x3c\x44\x78\x3c\x9f\xba\x25\x9f\xa8\xe3\x4b\xa8\x51\xf3\xa2\x51\xa3\xfe\x5d\xa3\x40\xc0\x80\x40\x8f\x8a\x05\x8f\x92\xad\x3f\x92\x9d\xbc\x21\x9d\x38\x48\x70\x38\xf5\x04\xf1\xf5\xbc\xdf\x63\xbc\xb6\xc1\x77\xb6\xda\x75\xaf\xda\x21\x63\x42\x21\x10\x30\x20\x10\xff\x1a\xe5\xff\xf3\x0e\xfd\xf3\xd2\x6d\xbf\xd2\xcd\x4c\x81\xcd\x0c\x14\x18\x0c\x13\x35\x26\x13\xec\x2f\xc3\xec\x5f\xe1\xbe\x5f\x97\xa2\x35\x97\x44\xcc\x88\x44\x17\x39\x2e\x17\xc4\x57\x93\xc4\xa7\xf2\x55\xa7\x7e\x82\xfc\x7e\x3d\x47\x7a\x3d\x64\xac\xc8\x64\x5d\xe7\xba\x5d\x19\x2b\x32\x19\x73\x95\xe6\x73\x60\xa0\xc0\x60\x81\x98\x19\x81\x4f\xd1\x9e\x4f\xdc\x7f\xa3\xdc\x22\x66\x44\x22\x2a\x7e\x54\x2a\x90\xab\x3b\x90\x88\x83\x0b\x88\x46\xca\x8c\x46\xee\x29\xc7\xee\xb8\xd3\x6b\xb8\x14\x3c\x28\x14\xde\x79\xa7\xde\x5e\xe2\xbc\x5e\x0b\x1d\x16\x0b\xdb\x76\xad\xdb\xe0\x3b\xdb\xe0\x32\x56\x64\x32\x3a\x4e\x74\x3a\x0a\x1e\x14\x0a\x49\xdb\x92\x49\x06\x0a\x0c\x06\x24\x6c\x48\x24\x5c\xe4\xb8\x5c\xc2\x5d\x9f\xc2\xd3\x6e\xbd\xd3\xac\xef\x43\xac\x62\xa6\xc4\x62\x91\xa8\x39\x91\x95\xa4\x31\x95\xe4\x37\xd3\xe4\x79\x8b\xf2\x79\xe7\x32\xd5\xe7\xc8\x43\x8b\xc8\x37\x59\x6e\x37\x6d\xb7\xda\x6d\x8d\x8c\x01\x8d\xd5\x64\xb1\xd5\x4e\xd2\x9c\x4e\xa9\xe0\x49\xa9\x6c\xb4\xd8\x6c\x56\xfa\xac\x56\xf4\x07\xf3\xf4\xea\x25\xcf\xea\x65\xaf\xca\x65\x7a\x8e\xf4\x7a\xae\xe9\x47\xae\x08\x18\x10\x08\xba\xd5\x6f\xba\x78\x88\xf0\x78\x25\x6f\x4a\x25\x2e\x72\x5c\x2e\x1c\x24\x38\x1c\xa6\xf1\x57\xa6\xb4\xc7\x73\xb4\xc6\x51\x97\xc6\xe8\x23\xcb\xe8\xdd\x7c\xa1\xdd\x74\x9c\xe8\x74\x1f\x21\x3e\x1f\x4b\xdd\x96\x4b\xbd\xdc\x61\xbd\x8b\x86\x0d\x8b\x8a\x85\x0f\x8a\x70\x90\xe0\x70\x3e\x42\x7c\x3e\xb5\xc4\x71\xb5\x66\xaa\xcc\x66\x48\xd8\x90\x48\x03\x05\x06\x03\xf6\x01\xf7\xf6\x0e\x12\x1c\x0e\x61\xa3\xc2\x61\x35\x5f\x6a\x35\x57\xf9\xae\x57\xb9\xd0\x69\xb9\x86\x91\x17\x86\xc1\x58\x99\xc1\x1d\x27\x3a\x1d\x9e\xb9\x27\x9e\xe1\x38\xd9\xe1\xf8\x13\xeb\xf8\x98\xb3\x2b\x98\x11\x33\x22\x11\x69\xbb\xd2\x69\xd9\x70\xa9\xd9\x8e\x89\x07\x8e\x94\xa7\x33\x94\x9b\xb6\x2d\x9b\x1e\x22\x3c\x1e\x87\x92\x15\x87\xe9\x20\xc9\xe9\xce\x49\x87\xce\x55\xff\xaa\x55\x28\x78\x50\x28\xdf\x7a\xa5\xdf\x8c\x8f\x03\x8c\xa1\xf8\x59\xa1\x89\x80\x09\x89\x0d\x17\x1a\x0d\xbf\xda\x65\xbf\xe6\x31\xd7\xe6\x42\xc6\x84\x42\x68\xb8\xd0\x68\x41\xc3\x82\x41\x99\xb0\x29\x99\x2d\x77\x5a\x2d\x0f\x11\x1e\x0f\xb0\xcb\x7b\xb0\x54\xfc\xa8\x54\xbb\xd6\x6d\xbb\x16\x3a\x2c\x16");
  static T4 = rawToIntArray("\x63\x63\xa5\xc6\x7c\x7c\x84\xf8\x77\x77\x99\xee\x7b\x7b\x8d\xf6\xf2\xf2\x0d\xff\x6b\x6b\xbd\xd6\x6f\x6f\xb1\xde\xc5\xc5\x54\x91\x30\x30\x50\x60\x01\x01\x03\x02\x67\x67\xa9\xce\x2b\x2b\x7d\x56\xfe\xfe\x19\xe7\xd7\xd7\x62\xb5\xab\xab\xe6\x4d\x76\x76\x9a\xec\xca\xca\x45\x8f\x82\x82\x9d\x1f\xc9\xc9\x40\x89\x7d\x7d\x87\xfa\xfa\xfa\x15\xef\x59\x59\xeb\xb2\x47\x47\xc9\x8e\xf0\xf0\x0b\xfb\xad\xad\xec\x41\xd4\xd4\x67\xb3\xa2\xa2\xfd\x5f\xaf\xaf\xea\x45\x9c\x9c\xbf\x23\xa4\xa4\xf7\x53\x72\x72\x96\xe4\xc0\xc0\x5b\x9b\xb7\xb7\xc2\x75\xfd\xfd\x1c\xe1\x93\x93\xae\x3d\x26\x26\x6a\x4c\x36\x36\x5a\x6c\x3f\x3f\x41\x7e\xf7\xf7\x02\xf5\xcc\xcc\x4f\x83\x34\x34\x5c\x68\xa5\xa5\xf4\x51\xe5\xe5\x34\xd1\xf1\xf1\x08\xf9\x71\x71\x93\xe2\xd8\xd8\x73\xab\x31\x31\x53\x62\x15\x15\x3f\x2a\x04\x04\x0c\x08\xc7\xc7\x52\x95\x23\x23\x65\x46\xc3\xc3\x5e\x9d\x18\x18\x28\x30\x96\x96\xa1\x37\x05\x05\x0f\x0a\x9a\x9a\xb5\x2f\x07\x07\x09\x0e\x12\x12\x36\x24\x80\x80\x9b\x1b\xe2\xe2\x3d\xdf\xeb\xeb\x26\xcd\x27\x27\x69\x4e\xb2\xb2\xcd\x7f\x75\x75\x9f\xea\x09\x09\x1b\x12\x83\x83\x9e\x1d\x2c\x2c\x74\x58\x1a\x1a\x2e\x34\x1b\x1b\x2d\x36\x6e\x6e\xb2\xdc\x5a\x5a\xee\xb4\xa0\xa0\xfb\x5b\x52\x52\xf6\xa4\x3b\x3b\x4d\x76\xd6\xd6\x61\xb7\xb3\xb3\xce\x7d\x29\x29\x7b\x52\xe3\xe3\x3e\xdd\x2f\x2f\x71\x5e\x84\x84\x97\x13\x53\x53\xf5\xa6\xd1\xd1\x68\xb9\x00\x00\x00\x00\xed\xed\x2c\xc1\x20\x20\x60\x40\xfc\xfc\x1f\xe3\xb1\xb1\xc8\x79\x5b\x5b\xed\xb6\x6a\x6a\xbe\xd4\xcb\xcb\x46\x8d\xbe\xbe\xd9\x67\x39\x39\x4b\x72\x4a\x4a\xde\x94\x4c\x4c\xd4\x98\x58\x58\xe8\xb0\xcf\xcf\x4a\x85\xd0\xd0\x6b\xbb\xef\xef\x2a\xc5\xaa\xaa\xe5\x4f\xfb\xfb\x16\xed\x43\x43\xc5\x86\x4d\x4d\xd7\x9a\x33\x33\x55\x66\x85\x85\x94\x11\x45\x45\xcf\x8a\xf9\xf9\x10\xe9\x02\x02\x06\x04\x7f\x7f\x81\xfe\x50\x50\xf0\xa0\x3c\x3c\x44\x78\x9f\x9f\xba\x25\xa8\xa8\xe3\x4b\x51\x51\xf3\xa2\xa3\xa3\xfe\x5d\x40\x40\xc0\x80\x8f\x8f\x8a\x05\x92\x92\xad\x3f\x9d\x9d\xbc\x21\x38\x38\x48\x70\xf5\xf5\x04\xf1\xbc\xbc\xdf\x63\xb6\xb6\xc1\x77\xda\xda\x75\xaf\x21\x21\x63\x42\x10\x10\x30\x20\xff\xff\x1a\xe5\xf3\xf3\x0e\xfd\xd2\xd2\x6d\xbf\xcd\xcd\x4c\x81\x0c\x0c\x14\x18\x13\x13\x35\x26\xec\xec\x2f\xc3\x5f\x5f\xe1\xbe\x97\x97\xa2\x35\x44\x44\xcc\x88\x17\x17\x39\x2e\xc4\xc4\x57\x93\xa7\xa7\xf2\x55\x7e\x7e\x82\xfc\x3d\x3d\x47\x7a\x64\x64\xac\xc8\x5d\x5d\xe7\xba\x19\x19\x2b\x32\x73\x73\x95\xe6\x60\x60\xa0\xc0\x81\x81\x98\x19\x4f\x4f\xd1\x9e\xdc\xdc\x7f\xa3\x22\x22\x66\x44\x2a\x2a\x7e\x54\x90\x90\xab\x3b\x88\x88\x83\x0b\x46\x46\xca\x8c\xee\xee\x29\xc7\xb8\xb8\xd3\x6b\x14\x14\x3c\x28\xde\xde\x79\xa7\x5e\x5e\xe2\xbc\x0b\x0b\x1d\x16\xdb\xdb\x76\xad\xe0\xe0\x3b\xdb\x32\x32\x56\x64\x3a\x3a\x4e\x74\x0a\x0a\x1e\x14\x49\x49\xdb\x92\x06\x06\x0a\x0c\x24\x24\x6c\x48\x5c\x5c\xe4\xb8\xc2\xc2\x5d\x9f\xd3\xd3\x6e\xbd\xac\xac\xef\x43\x62\x62\xa6\xc4\x91\x91\xa8\x39\x95\x95\xa4\x31\xe4\xe4\x37\xd3\x79\x79\x8b\xf2\xe7\xe7\x32\xd5\xc8\xc8\x43\x8b\x37\x37\x59\x6e\x6d\x6d\xb7\xda\x8d\x8d\x8c\x01\xd5\xd5\x64\xb1\x4e\x4e\xd2\x9c\xa9\xa9\xe0\x49\x6c\x6c\xb4\xd8\x56\x56\xfa\xac\xf4\xf4\x07\xf3\xea\xea\x25\xcf\x65\x65\xaf\xca\x7a\x7a\x8e\xf4\xae\xae\xe9\x47\x08\x08\x18\x10\xba\xba\xd5\x6f\x78\x78\x88\xf0\x25\x25\x6f\x4a\x2e\x2e\x72\x5c\x1c\x1c\x24\x38\xa6\xa6\xf1\x57\xb4\xb4\xc7\x73\xc6\xc6\x51\x97\xe8\xe8\x23\xcb\xdd\xdd\x7c\xa1\x74\x74\x9c\xe8\x1f\x1f\x21\x3e\x4b\x4b\xdd\x96\xbd\xbd\xdc\x61\x8b\x8b\x86\x0d\x8a\x8a\x85\x0f\x70\x70\x90\xe0\x3e\x3e\x42\x7c\xb5\xb5\xc4\x71\x66\x66\xaa\xcc\x48\x48\xd8\x90\x03\x03\x05\x06\xf6\xf6\x01\xf7\x0e\x0e\x12\x1c\x61\x61\xa3\xc2\x35\x35\x5f\x6a\x57\x57\xf9\xae\xb9\xb9\xd0\x69\x86\x86\x91\x17\xc1\xc1\x58\x99\x1d\x1d\x27\x3a\x9e\x9e\xb9\x27\xe1\xe1\x38\xd9\xf8\xf8\x13\xeb\x98\x98\xb3\x2b\x11\x11\x33\x22\x69\x69\xbb\xd2\xd9\xd9\x70\xa9\x8e\x8e\x89\x07\x94\x94\xa7\x33\x9b\x9b\xb6\x2d\x1e\x1e\x22\x3c\x87\x87\x92\x15\xe9\xe9\x20\xc9\xce\xce\x49\x87\x55\x55\xff\xaa\x28\x28\x78\x50\xdf\xdf\x7a\xa5\x8c\x8c\x8f\x03\xa1\xa1\xf8\x59\x89\x89\x80\x09\x0d\x0d\x17\x1a\xbf\xbf\xda\x65\xe6\xe6\x31\xd7\x42\x42\xc6\x84\x68\x68\xb8\xd0\x41\x41\xc3\x82\x99\x99\xb0\x29\x2d\x2d\x77\x5a\x0f\x0f\x11\x1e\xb0\xb0\xcb\x7b\x54\x54\xfc\xa8\xbb\xbb\xd6\x6d\x16\x16\x3a\x2c");

  // Transformations for decryption
  static T5 = rawToIntArray("\x51\xf4\xa7\x50\x7e\x41\x65\x53\x1a\x17\xa4\xc3\x3a\x27\x5e\x96\x3b\xab\x6b\xcb\x1f\x9d\x45\xf1\xac\xfa\x58\xab\x4b\xe3\x03\x93\x20\x30\xfa\x55\xad\x76\x6d\xf6\x88\xcc\x76\x91\xf5\x02\x4c\x25\x4f\xe5\xd7\xfc\xc5\x2a\xcb\xd7\x26\x35\x44\x80\xb5\x62\xa3\x8f\xde\xb1\x5a\x49\x25\xba\x1b\x67\x45\xea\x0e\x98\x5d\xfe\xc0\xe1\xc3\x2f\x75\x02\x81\x4c\xf0\x12\x8d\x46\x97\xa3\x6b\xd3\xf9\xc6\x03\x8f\x5f\xe7\x15\x92\x9c\x95\xbf\x6d\x7a\xeb\x95\x52\x59\xda\xd4\xbe\x83\x2d\x58\x74\x21\xd3\x49\xe0\x69\x29\x8e\xc9\xc8\x44\x75\xc2\x89\x6a\xf4\x8e\x79\x78\x99\x58\x3e\x6b\x27\xb9\x71\xdd\xbe\xe1\x4f\xb6\xf0\x88\xad\x17\xc9\x20\xac\x66\x7d\xce\x3a\xb4\x63\xdf\x4a\x18\xe5\x1a\x31\x82\x97\x51\x33\x60\x62\x53\x7f\x45\xb1\x64\x77\xe0\xbb\x6b\xae\x84\xfe\x81\xa0\x1c\xf9\x08\x2b\x94\x70\x48\x68\x58\x8f\x45\xfd\x19\x94\xde\x6c\x87\x52\x7b\xf8\xb7\xab\x73\xd3\x23\x72\x4b\x02\xe2\xe3\x1f\x8f\x57\x66\x55\xab\x2a\xb2\xeb\x28\x07\x2f\xb5\xc2\x03\x86\xc5\x7b\x9a\xd3\x37\x08\xa5\x30\x28\x87\xf2\x23\xbf\xa5\xb2\x02\x03\x6a\xba\xed\x16\x82\x5c\x8a\xcf\x1c\x2b\xa7\x79\xb4\x92\xf3\x07\xf2\xf0\x4e\x69\xe2\xa1\x65\xda\xf4\xcd\x06\x05\xbe\xd5\xd1\x34\x62\x1f\xc4\xa6\xfe\x8a\x34\x2e\x53\x9d\xa2\xf3\x55\xa0\x05\x8a\xe1\x32\xa4\xf6\xeb\x75\x0b\x83\xec\x39\x40\x60\xef\xaa\x5e\x71\x9f\x06\xbd\x6e\x10\x51\x3e\x21\x8a\xf9\x96\xdd\x06\x3d\xdd\x3e\x05\xae\x4d\xe6\xbd\x46\x91\x54\x8d\xb5\x71\xc4\x5d\x05\x04\x06\xd4\x6f\x60\x50\x15\xff\x19\x98\xfb\x24\xd6\xbd\xe9\x97\x89\x40\x43\xcc\x67\xd9\x9e\x77\xb0\xe8\x42\xbd\x07\x89\x8b\x88\xe7\x19\x5b\x38\x79\xc8\xee\xdb\xa1\x7c\x0a\x47\x7c\x42\x0f\xe9\xf8\x84\x1e\xc9\x00\x00\x00\x00\x09\x80\x86\x83\x32\x2b\xed\x48\x1e\x11\x70\xac\x6c\x5a\x72\x4e\xfd\x0e\xff\xfb\x0f\x85\x38\x56\x3d\xae\xd5\x1e\x36\x2d\x39\x27\x0a\x0f\xd9\x64\x68\x5c\xa6\x21\x9b\x5b\x54\xd1\x24\x36\x2e\x3a\x0c\x0a\x67\xb1\x93\x57\xe7\x0f\xb4\xee\x96\xd2\x1b\x9b\x91\x9e\x80\xc0\xc5\x4f\x61\xdc\x20\xa2\x5a\x77\x4b\x69\x1c\x12\x1a\x16\xe2\x93\xba\x0a\xc0\xa0\x2a\xe5\x3c\x22\xe0\x43\x12\x1b\x17\x1d\x0e\x09\x0d\x0b\xf2\x8b\xc7\xad\x2d\xb6\xa8\xb9\x14\x1e\xa9\xc8\x57\xf1\x19\x85\xaf\x75\x07\x4c\xee\x99\xdd\xbb\xa3\x7f\x60\xfd\xf7\x01\x26\x9f\x5c\x72\xf5\xbc\x44\x66\x3b\xc5\x5b\xfb\x7e\x34\x8b\x43\x29\x76\xcb\x23\xc6\xdc\xb6\xed\xfc\x68\xb8\xe4\xf1\x63\xd7\x31\xdc\xca\x42\x63\x85\x10\x13\x97\x22\x40\x84\xc6\x11\x20\x85\x4a\x24\x7d\xd2\xbb\x3d\xf8\xae\xf9\x32\x11\xc7\x29\xa1\x6d\x1d\x9e\x2f\x4b\xdc\xb2\x30\xf3\x0d\x86\x52\xec\x77\xc1\xe3\xd0\x2b\xb3\x16\x6c\xa9\x70\xb9\x99\x11\x94\x48\xfa\x47\xe9\x64\x22\xa8\xfc\x8c\xc4\xa0\xf0\x3f\x1a\x56\x7d\x2c\xd8\x22\x33\x90\xef\x87\x49\x4e\xc7\xd9\x38\xd1\xc1\x8c\xca\xa2\xfe\x98\xd4\x0b\x36\xa6\xf5\x81\xcf\xa5\x7a\xde\x28\xda\xb7\x8e\x26\x3f\xad\xbf\xa4\x2c\x3a\x9d\xe4\x50\x78\x92\x0d\x6a\x5f\xcc\x9b\x54\x7e\x46\x62\xf6\x8d\x13\xc2\x90\xd8\xb8\xe8\x2e\x39\xf7\x5e\x82\xc3\xaf\xf5\x9f\x5d\x80\xbe\x69\xd0\x93\x7c\x6f\xd5\x2d\xa9\xcf\x25\x12\xb3\xc8\xac\x99\x3b\x10\x18\x7d\xa7\xe8\x9c\x63\x6e\xdb\x3b\xbb\x7b\xcd\x26\x78\x09\x6e\x59\x18\xf4\xec\x9a\xb7\x01\x83\x4f\x9a\xa8\xe6\x95\x6e\x65\xaa\xff\xe6\x7e\x21\xbc\xcf\x08\xef\x15\xe8\xe6\xba\xe7\x9b\xd9\x4a\x6f\x36\xce\xea\x9f\x09\xd4\x29\xb0\x7c\xd6\x31\xa4\xb2\xaf\x2a\x3f\x23\x31\xc6\xa5\x94\x30\x35\xa2\x66\xc0\x74\x4e\xbc\x37\xfc\x82\xca\xa6\xe0\x90\xd0\xb0\x33\xa7\xd8\x15\xf1\x04\x98\x4a\x41\xec\xda\xf7\x7f\xcd\x50\x0e\x17\x91\xf6\x2f\x76\x4d\xd6\x8d\x43\xef\xb0\x4d\xcc\xaa\x4d\x54\xe4\x96\x04\xdf\x9e\xd1\xb5\xe3\x4c\x6a\x88\x1b\xc1\x2c\x1f\xb8\x46\x65\x51\x7f\x9d\x5e\xea\x04\x01\x8c\x35\x5d\xfa\x87\x74\x73\xfb\x0b\x41\x2e\xb3\x67\x1d\x5a\x92\xdb\xd2\x52\xe9\x10\x56\x33\x6d\xd6\x47\x13\x9a\xd7\x61\x8c\x37\xa1\x0c\x7a\x59\xf8\x14\x8e\xeb\x13\x3c\x89\xce\xa9\x27\xee\xb7\x61\xc9\x35\xe1\x1c\xe5\xed\x7a\x47\xb1\x3c\x9c\xd2\xdf\x59\x55\xf2\x73\x3f\x18\x14\xce\x79\x73\xc7\x37\xbf\x53\xf7\xcd\xea\x5f\xfd\xaa\x5b\xdf\x3d\x6f\x14\x78\x44\xdb\x86\xca\xaf\xf3\x81\xb9\x68\xc4\x3e\x38\x24\x34\x2c\xc2\xa3\x40\x5f\x16\x1d\xc3\x72\xbc\xe2\x25\x0c\x28\x3c\x49\x8b\xff\x0d\x95\x41\x39\xa8\x01\x71\x08\x0c\xb3\xde\xd8\xb4\xe4\x9c\x64\x56\xc1\x90\x7b\xcb\x84\x61\xd5\x32\xb6\x70\x48\x6c\x5c\x74\xd0\xb8\x57\x42");
  static T6 = rawToIntArray("\x50\x51\xf4\xa7\x53\x7e\x41\x65\xc3\x1a\x17\xa4\x96\x3a\x27\x5e\xcb\x3b\xab\x6b\xf1\x1f\x9d\x45\xab\xac\xfa\x58\x93\x4b\xe3\x03\x55\x20\x30\xfa\xf6\xad\x76\x6d\x91\x88\xcc\x76\x25\xf5\x02\x4c\xfc\x4f\xe5\xd7\xd7\xc5\x2a\xcb\x80\x26\x35\x44\x8f\xb5\x62\xa3\x49\xde\xb1\x5a\x67\x25\xba\x1b\x98\x45\xea\x0e\xe1\x5d\xfe\xc0\x02\xc3\x2f\x75\x12\x81\x4c\xf0\xa3\x8d\x46\x97\xc6\x6b\xd3\xf9\xe7\x03\x8f\x5f\x95\x15\x92\x9c\xeb\xbf\x6d\x7a\xda\x95\x52\x59\x2d\xd4\xbe\x83\xd3\x58\x74\x21\x29\x49\xe0\x69\x44\x8e\xc9\xc8\x6a\x75\xc2\x89\x78\xf4\x8e\x79\x6b\x99\x58\x3e\xdd\x27\xb9\x71\xb6\xbe\xe1\x4f\x17\xf0\x88\xad\x66\xc9\x20\xac\xb4\x7d\xce\x3a\x18\x63\xdf\x4a\x82\xe5\x1a\x31\x60\x97\x51\x33\x45\x62\x53\x7f\xe0\xb1\x64\x77\x84\xbb\x6b\xae\x1c\xfe\x81\xa0\x94\xf9\x08\x2b\x58\x70\x48\x68\x19\x8f\x45\xfd\x87\x94\xde\x6c\xb7\x52\x7b\xf8\x23\xab\x73\xd3\xe2\x72\x4b\x02\x57\xe3\x1f\x8f\x2a\x66\x55\xab\x07\xb2\xeb\x28\x03\x2f\xb5\xc2\x9a\x86\xc5\x7b\xa5\xd3\x37\x08\xf2\x30\x28\x87\xb2\x23\xbf\xa5\xba\x02\x03\x6a\x5c\xed\x16\x82\x2b\x8a\xcf\x1c\x92\xa7\x79\xb4\xf0\xf3\x07\xf2\xa1\x4e\x69\xe2\xcd\x65\xda\xf4\xd5\x06\x05\xbe\x1f\xd1\x34\x62\x8a\xc4\xa6\xfe\x9d\x34\x2e\x53\xa0\xa2\xf3\x55\x32\x05\x8a\xe1\x75\xa4\xf6\xeb\x39\x0b\x83\xec\xaa\x40\x60\xef\x06\x5e\x71\x9f\x51\xbd\x6e\x10\xf9\x3e\x21\x8a\x3d\x96\xdd\x06\xae\xdd\x3e\x05\x46\x4d\xe6\xbd\xb5\x91\x54\x8d\x05\x71\xc4\x5d\x6f\x04\x06\xd4\xff\x60\x50\x15\x24\x19\x98\xfb\x97\xd6\xbd\xe9\xcc\x89\x40\x43\x77\x67\xd9\x9e\xbd\xb0\xe8\x42\x88\x07\x89\x8b\x38\xe7\x19\x5b\xdb\x79\xc8\xee\x47\xa1\x7c\x0a\xe9\x7c\x42\x0f\xc9\xf8\x84\x1e\x00\x00\x00\x00\x83\x09\x80\x86\x48\x32\x2b\xed\xac\x1e\x11\x70\x4e\x6c\x5a\x72\xfb\xfd\x0e\xff\x56\x0f\x85\x38\x1e\x3d\xae\xd5\x27\x36\x2d\x39\x64\x0a\x0f\xd9\x21\x68\x5c\xa6\xd1\x9b\x5b\x54\x3a\x24\x36\x2e\xb1\x0c\x0a\x67\x0f\x93\x57\xe7\xd2\xb4\xee\x96\x9e\x1b\x9b\x91\x4f\x80\xc0\xc5\xa2\x61\xdc\x20\x69\x5a\x77\x4b\x16\x1c\x12\x1a\x0a\xe2\x93\xba\xe5\xc0\xa0\x2a\x43\x3c\x22\xe0\x1d\x12\x1b\x17\x0b\x0e\x09\x0d\xad\xf2\x8b\xc7\xb9\x2d\xb6\xa8\xc8\x14\x1e\xa9\x85\x57\xf1\x19\x4c\xaf\x75\x07\xbb\xee\x99\xdd\xfd\xa3\x7f\x60\x9f\xf7\x01\x26\xbc\x5c\x72\xf5\xc5\x44\x66\x3b\x34\x5b\xfb\x7e\x76\x8b\x43\x29\xdc\xcb\x23\xc6\x68\xb6\xed\xfc\x63\xb8\xe4\xf1\xca\xd7\x31\xdc\x10\x42\x63\x85\x40\x13\x97\x22\x20\x84\xc6\x11\x7d\x85\x4a\x24\xf8\xd2\xbb\x3d\x11\xae\xf9\x32\x6d\xc7\x29\xa1\x4b\x1d\x9e\x2f\xf3\xdc\xb2\x30\xec\x0d\x86\x52\xd0\x77\xc1\xe3\x6c\x2b\xb3\x16\x99\xa9\x70\xb9\xfa\x11\x94\x48\x22\x47\xe9\x64\xc4\xa8\xfc\x8c\x1a\xa0\xf0\x3f\xd8\x56\x7d\x2c\xef\x22\x33\x90\xc7\x87\x49\x4e\xc1\xd9\x38\xd1\xfe\x8c\xca\xa2\x36\x98\xd4\x0b\xcf\xa6\xf5\x81\x28\xa5\x7a\xde\x26\xda\xb7\x8e\xa4\x3f\xad\xbf\xe4\x2c\x3a\x9d\x0d\x50\x78\x92\x9b\x6a\x5f\xcc\x62\x54\x7e\x46\xc2\xf6\x8d\x13\xe8\x90\xd8\xb8\x5e\x2e\x39\xf7\xf5\x82\xc3\xaf\xbe\x9f\x5d\x80\x7c\x69\xd0\x93\xa9\x6f\xd5\x2d\xb3\xcf\x25\x12\x3b\xc8\xac\x99\xa7\x10\x18\x7d\x6e\xe8\x9c\x63\x7b\xdb\x3b\xbb\x09\xcd\x26\x78\xf4\x6e\x59\x18\x01\xec\x9a\xb7\xa8\x83\x4f\x9a\x65\xe6\x95\x6e\x7e\xaa\xff\xe6\x08\x21\xbc\xcf\xe6\xef\x15\xe8\xd9\xba\xe7\x9b\xce\x4a\x6f\x36\xd4\xea\x9f\x09\xd6\x29\xb0\x7c\xaf\x31\xa4\xb2\x31\x2a\x3f\x23\x30\xc6\xa5\x94\xc0\x35\xa2\x66\x37\x74\x4e\xbc\xa6\xfc\x82\xca\xb0\xe0\x90\xd0\x15\x33\xa7\xd8\x4a\xf1\x04\x98\xf7\x41\xec\xda\x0e\x7f\xcd\x50\x2f\x17\x91\xf6\x8d\x76\x4d\xd6\x4d\x43\xef\xb0\x54\xcc\xaa\x4d\xdf\xe4\x96\x04\xe3\x9e\xd1\xb5\x1b\x4c\x6a\x88\xb8\xc1\x2c\x1f\x7f\x46\x65\x51\x04\x9d\x5e\xea\x5d\x01\x8c\x35\x73\xfa\x87\x74\x2e\xfb\x0b\x41\x5a\xb3\x67\x1d\x52\x92\xdb\xd2\x33\xe9\x10\x56\x13\x6d\xd6\x47\x8c\x9a\xd7\x61\x7a\x37\xa1\x0c\x8e\x59\xf8\x14\x89\xeb\x13\x3c\xee\xce\xa9\x27\x35\xb7\x61\xc9\xed\xe1\x1c\xe5\x3c\x7a\x47\xb1\x59\x9c\xd2\xdf\x3f\x55\xf2\x73\x79\x18\x14\xce\xbf\x73\xc7\x37\xea\x53\xf7\xcd\x5b\x5f\xfd\xaa\x14\xdf\x3d\x6f\x86\x78\x44\xdb\x81\xca\xaf\xf3\x3e\xb9\x68\xc4\x2c\x38\x24\x34\x5f\xc2\xa3\x40\x72\x16\x1d\xc3\x0c\xbc\xe2\x25\x8b\x28\x3c\x49\x41\xff\x0d\x95\x71\x39\xa8\x01\xde\x08\x0c\xb3\x9c\xd8\xb4\xe4\x90\x64\x56\xc1\x61\x7b\xcb\x84\x70\xd5\x32\xb6\x74\x48\x6c\x5c\x42\xd0\xb8\x57");
  static T7 = rawToIntArray("\xa7\x50\x51\xf4\x65\x53\x7e\x41\xa4\xc3\x1a\x17\x5e\x96\x3a\x27\x6b\xcb\x3b\xab\x45\xf1\x1f\x9d\x58\xab\xac\xfa\x03\x93\x4b\xe3\xfa\x55\x20\x30\x6d\xf6\xad\x76\x76\x91\x88\xcc\x4c\x25\xf5\x02\xd7\xfc\x4f\xe5\xcb\xd7\xc5\x2a\x44\x80\x26\x35\xa3\x8f\xb5\x62\x5a\x49\xde\xb1\x1b\x67\x25\xba\x0e\x98\x45\xea\xc0\xe1\x5d\xfe\x75\x02\xc3\x2f\xf0\x12\x81\x4c\x97\xa3\x8d\x46\xf9\xc6\x6b\xd3\x5f\xe7\x03\x8f\x9c\x95\x15\x92\x7a\xeb\xbf\x6d\x59\xda\x95\x52\x83\x2d\xd4\xbe\x21\xd3\x58\x74\x69\x29\x49\xe0\xc8\x44\x8e\xc9\x89\x6a\x75\xc2\x79\x78\xf4\x8e\x3e\x6b\x99\x58\x71\xdd\x27\xb9\x4f\xb6\xbe\xe1\xad\x17\xf0\x88\xac\x66\xc9\x20\x3a\xb4\x7d\xce\x4a\x18\x63\xdf\x31\x82\xe5\x1a\x33\x60\x97\x51\x7f\x45\x62\x53\x77\xe0\xb1\x64\xae\x84\xbb\x6b\xa0\x1c\xfe\x81\x2b\x94\xf9\x08\x68\x58\x70\x48\xfd\x19\x8f\x45\x6c\x87\x94\xde\xf8\xb7\x52\x7b\xd3\x23\xab\x73\x02\xe2\x72\x4b\x8f\x57\xe3\x1f\xab\x2a\x66\x55\x28\x07\xb2\xeb\xc2\x03\x2f\xb5\x7b\x9a\x86\xc5\x08\xa5\xd3\x37\x87\xf2\x30\x28\xa5\xb2\x23\xbf\x6a\xba\x02\x03\x82\x5c\xed\x16\x1c\x2b\x8a\xcf\xb4\x92\xa7\x79\xf2\xf0\xf3\x07\xe2\xa1\x4e\x69\xf4\xcd\x65\xda\xbe\xd5\x06\x05\x62\x1f\xd1\x34\xfe\x8a\xc4\xa6\x53\x9d\x34\x2e\x55\xa0\xa2\xf3\xe1\x32\x05\x8a\xeb\x75\xa4\xf6\xec\x39\x0b\x83\xef\xaa\x40\x60\x9f\x06\x5e\x71\x10\x51\xbd\x6e\x8a\xf9\x3e\x21\x06\x3d\x96\xdd\x05\xae\xdd\x3e\xbd\x46\x4d\xe6\x8d\xb5\x91\x54\x5d\x05\x71\xc4\xd4\x6f\x04\x06\x15\xff\x60\x50\xfb\x24\x19\x98\xe9\x97\xd6\xbd\x43\xcc\x89\x40\x9e\x77\x67\xd9\x42\xbd\xb0\xe8\x8b\x88\x07\x89\x5b\x38\xe7\x19\xee\xdb\x79\xc8\x0a\x47\xa1\x7c\x0f\xe9\x7c\x42\x1e\xc9\xf8\x84\x00\x00\x00\x00\x86\x83\x09\x80\xed\x48\x32\x2b\x70\xac\x1e\x11\x72\x4e\x6c\x5a\xff\xfb\xfd\x0e\x38\x56\x0f\x85\xd5\x1e\x3d\xae\x39\x27\x36\x2d\xd9\x64\x0a\x0f\xa6\x21\x68\x5c\x54\xd1\x9b\x5b\x2e\x3a\x24\x36\x67\xb1\x0c\x0a\xe7\x0f\x93\x57\x96\xd2\xb4\xee\x91\x9e\x1b\x9b\xc5\x4f\x80\xc0\x20\xa2\x61\xdc\x4b\x69\x5a\x77\x1a\x16\x1c\x12\xba\x0a\xe2\x93\x2a\xe5\xc0\xa0\xe0\x43\x3c\x22\x17\x1d\x12\x1b\x0d\x0b\x0e\x09\xc7\xad\xf2\x8b\xa8\xb9\x2d\xb6\xa9\xc8\x14\x1e\x19\x85\x57\xf1\x07\x4c\xaf\x75\xdd\xbb\xee\x99\x60\xfd\xa3\x7f\x26\x9f\xf7\x01\xf5\xbc\x5c\x72\x3b\xc5\x44\x66\x7e\x34\x5b\xfb\x29\x76\x8b\x43\xc6\xdc\xcb\x23\xfc\x68\xb6\xed\xf1\x63\xb8\xe4\xdc\xca\xd7\x31\x85\x10\x42\x63\x22\x40\x13\x97\x11\x20\x84\xc6\x24\x7d\x85\x4a\x3d\xf8\xd2\xbb\x32\x11\xae\xf9\xa1\x6d\xc7\x29\x2f\x4b\x1d\x9e\x30\xf3\xdc\xb2\x52\xec\x0d\x86\xe3\xd0\x77\xc1\x16\x6c\x2b\xb3\xb9\x99\xa9\x70\x48\xfa\x11\x94\x64\x22\x47\xe9\x8c\xc4\xa8\xfc\x3f\x1a\xa0\xf0\x2c\xd8\x56\x7d\x90\xef\x22\x33\x4e\xc7\x87\x49\xd1\xc1\xd9\x38\xa2\xfe\x8c\xca\x0b\x36\x98\xd4\x81\xcf\xa6\xf5\xde\x28\xa5\x7a\x8e\x26\xda\xb7\xbf\xa4\x3f\xad\x9d\xe4\x2c\x3a\x92\x0d\x50\x78\xcc\x9b\x6a\x5f\x46\x62\x54\x7e\x13\xc2\xf6\x8d\xb8\xe8\x90\xd8\xf7\x5e\x2e\x39\xaf\xf5\x82\xc3\x80\xbe\x9f\x5d\x93\x7c\x69\xd0\x2d\xa9\x6f\xd5\x12\xb3\xcf\x25\x99\x3b\xc8\xac\x7d\xa7\x10\x18\x63\x6e\xe8\x9c\xbb\x7b\xdb\x3b\x78\x09\xcd\x26\x18\xf4\x6e\x59\xb7\x01\xec\x9a\x9a\xa8\x83\x4f\x6e\x65\xe6\x95\xe6\x7e\xaa\xff\xcf\x08\x21\xbc\xe8\xe6\xef\x15\x9b\xd9\xba\xe7\x36\xce\x4a\x6f\x09\xd4\xea\x9f\x7c\xd6\x29\xb0\xb2\xaf\x31\xa4\x23\x31\x2a\x3f\x94\x30\xc6\xa5\x66\xc0\x35\xa2\xbc\x37\x74\x4e\xca\xa6\xfc\x82\xd0\xb0\xe0\x90\xd8\x15\x33\xa7\x98\x4a\xf1\x04\xda\xf7\x41\xec\x50\x0e\x7f\xcd\xf6\x2f\x17\x91\xd6\x8d\x76\x4d\xb0\x4d\x43\xef\x4d\x54\xcc\xaa\x04\xdf\xe4\x96\xb5\xe3\x9e\xd1\x88\x1b\x4c\x6a\x1f\xb8\xc1\x2c\x51\x7f\x46\x65\xea\x04\x9d\x5e\x35\x5d\x01\x8c\x74\x73\xfa\x87\x41\x2e\xfb\x0b\x1d\x5a\xb3\x67\xd2\x52\x92\xdb\x56\x33\xe9\x10\x47\x13\x6d\xd6\x61\x8c\x9a\xd7\x0c\x7a\x37\xa1\x14\x8e\x59\xf8\x3c\x89\xeb\x13\x27\xee\xce\xa9\xc9\x35\xb7\x61\xe5\xed\xe1\x1c\xb1\x3c\x7a\x47\xdf\x59\x9c\xd2\x73\x3f\x55\xf2\xce\x79\x18\x14\x37\xbf\x73\xc7\xcd\xea\x53\xf7\xaa\x5b\x5f\xfd\x6f\x14\xdf\x3d\xdb\x86\x78\x44\xf3\x81\xca\xaf\xc4\x3e\xb9\x68\x34\x2c\x38\x24\x40\x5f\xc2\xa3\xc3\x72\x16\x1d\x25\x0c\xbc\xe2\x49\x8b\x28\x3c\x95\x41\xff\x0d\x01\x71\x39\xa8\xb3\xde\x08\x0c\xe4\x9c\xd8\xb4\xc1\x90\x64\x56\x84\x61\x7b\xcb\xb6\x70\xd5\x32\x5c\x74\x48\x6c\x57\x42\xd0\xb8");
  static T8 = rawToIntArray("\xf4\xa7\x50\x51\x41\x65\x53\x7e\x17\xa4\xc3\x1a\x27\x5e\x96\x3a\xab\x6b\xcb\x3b\x9d\x45\xf1\x1f\xfa\x58\xab\xac\xe3\x03\x93\x4b\x30\xfa\x55\x20\x76\x6d\xf6\xad\xcc\x76\x91\x88\x02\x4c\x25\xf5\xe5\xd7\xfc\x4f\x2a\xcb\xd7\xc5\x35\x44\x80\x26\x62\xa3\x8f\xb5\xb1\x5a\x49\xde\xba\x1b\x67\x25\xea\x0e\x98\x45\xfe\xc0\xe1\x5d\x2f\x75\x02\xc3\x4c\xf0\x12\x81\x46\x97\xa3\x8d\xd3\xf9\xc6\x6b\x8f\x5f\xe7\x03\x92\x9c\x95\x15\x6d\x7a\xeb\xbf\x52\x59\xda\x95\xbe\x83\x2d\xd4\x74\x21\xd3\x58\xe0\x69\x29\x49\xc9\xc8\x44\x8e\xc2\x89\x6a\x75\x8e\x79\x78\xf4\x58\x3e\x6b\x99\xb9\x71\xdd\x27\xe1\x4f\xb6\xbe\x88\xad\x17\xf0\x20\xac\x66\xc9\xce\x3a\xb4\x7d\xdf\x4a\x18\x63\x1a\x31\x82\xe5\x51\x33\x60\x97\x53\x7f\x45\x62\x64\x77\xe0\xb1\x6b\xae\x84\xbb\x81\xa0\x1c\xfe\x08\x2b\x94\xf9\x48\x68\x58\x70\x45\xfd\x19\x8f\xde\x6c\x87\x94\x7b\xf8\xb7\x52\x73\xd3\x23\xab\x4b\x02\xe2\x72\x1f\x8f\x57\xe3\x55\xab\x2a\x66\xeb\x28\x07\xb2\xb5\xc2\x03\x2f\xc5\x7b\x9a\x86\x37\x08\xa5\xd3\x28\x87\xf2\x30\xbf\xa5\xb2\x23\x03\x6a\xba\x02\x16\x82\x5c\xed\xcf\x1c\x2b\x8a\x79\xb4\x92\xa7\x07\xf2\xf0\xf3\x69\xe2\xa1\x4e\xda\xf4\xcd\x65\x05\xbe\xd5\x06\x34\x62\x1f\xd1\xa6\xfe\x8a\xc4\x2e\x53\x9d\x34\xf3\x55\xa0\xa2\x8a\xe1\x32\x05\xf6\xeb\x75\xa4\x83\xec\x39\x0b\x60\xef\xaa\x40\x71\x9f\x06\x5e\x6e\x10\x51\xbd\x21\x8a\xf9\x3e\xdd\x06\x3d\x96\x3e\x05\xae\xdd\xe6\xbd\x46\x4d\x54\x8d\xb5\x91\xc4\x5d\x05\x71\x06\xd4\x6f\x04\x50\x15\xff\x60\x98\xfb\x24\x19\xbd\xe9\x97\xd6\x40\x43\xcc\x89\xd9\x9e\x77\x67\xe8\x42\xbd\xb0\x89\x8b\x88\x07\x19\x5b\x38\xe7\xc8\xee\xdb\x79\x7c\x0a\x47\xa1\x42\x0f\xe9\x7c\x84\x1e\xc9\xf8\x00\x00\x00\x00\x80\x86\x83\x09\x2b\xed\x48\x32\x11\x70\xac\x1e\x5a\x72\x4e\x6c\x0e\xff\xfb\xfd\x85\x38\x56\x0f\xae\xd5\x1e\x3d\x2d\x39\x27\x36\x0f\xd9\x64\x0a\x5c\xa6\x21\x68\x5b\x54\xd1\x9b\x36\x2e\x3a\x24\x0a\x67\xb1\x0c\x57\xe7\x0f\x93\xee\x96\xd2\xb4\x9b\x91\x9e\x1b\xc0\xc5\x4f\x80\xdc\x20\xa2\x61\x77\x4b\x69\x5a\x12\x1a\x16\x1c\x93\xba\x0a\xe2\xa0\x2a\xe5\xc0\x22\xe0\x43\x3c\x1b\x17\x1d\x12\x09\x0d\x0b\x0e\x8b\xc7\xad\xf2\xb6\xa8\xb9\x2d\x1e\xa9\xc8\x14\xf1\x19\x85\x57\x75\x07\x4c\xaf\x99\xdd\xbb\xee\x7f\x60\xfd\xa3\x01\x26\x9f\xf7\x72\xf5\xbc\x5c\x66\x3b\xc5\x44\xfb\x7e\x34\x5b\x43\x29\x76\x8b\x23\xc6\xdc\xcb\xed\xfc\x68\xb6\xe4\xf1\x63\xb8\x31\xdc\xca\xd7\x63\x85\x10\x42\x97\x22\x40\x13\xc6\x11\x20\x84\x4a\x24\x7d\x85\xbb\x3d\xf8\xd2\xf9\x32\x11\xae\x29\xa1\x6d\xc7\x9e\x2f\x4b\x1d\xb2\x30\xf3\xdc\x86\x52\xec\x0d\xc1\xe3\xd0\x77\xb3\x16\x6c\x2b\x70\xb9\x99\xa9\x94\x48\xfa\x11\xe9\x64\x22\x47\xfc\x8c\xc4\xa8\xf0\x3f\x1a\xa0\x7d\x2c\xd8\x56\x33\x90\xef\x22\x49\x4e\xc7\x87\x38\xd1\xc1\xd9\xca\xa2\xfe\x8c\xd4\x0b\x36\x98\xf5\x81\xcf\xa6\x7a\xde\x28\xa5\xb7\x8e\x26\xda\xad\xbf\xa4\x3f\x3a\x9d\xe4\x2c\x78\x92\x0d\x50\x5f\xcc\x9b\x6a\x7e\x46\x62\x54\x8d\x13\xc2\xf6\xd8\xb8\xe8\x90\x39\xf7\x5e\x2e\xc3\xaf\xf5\x82\x5d\x80\xbe\x9f\xd0\x93\x7c\x69\xd5\x2d\xa9\x6f\x25\x12\xb3\xcf\xac\x99\x3b\xc8\x18\x7d\xa7\x10\x9c\x63\x6e\xe8\x3b\xbb\x7b\xdb\x26\x78\x09\xcd\x59\x18\xf4\x6e\x9a\xb7\x01\xec\x4f\x9a\xa8\x83\x95\x6e\x65\xe6\xff\xe6\x7e\xaa\xbc\xcf\x08\x21\x15\xe8\xe6\xef\xe7\x9b\xd9\xba\x6f\x36\xce\x4a\x9f\x09\xd4\xea\xb0\x7c\xd6\x29\xa4\xb2\xaf\x31\x3f\x23\x31\x2a\xa5\x94\x30\xc6\xa2\x66\xc0\x35\x4e\xbc\x37\x74\x82\xca\xa6\xfc\x90\xd0\xb0\xe0\xa7\xd8\x15\x33\x04\x98\x4a\xf1\xec\xda\xf7\x41\xcd\x50\x0e\x7f\x91\xf6\x2f\x17\x4d\xd6\x8d\x76\xef\xb0\x4d\x43\xaa\x4d\x54\xcc\x96\x04\xdf\xe4\xd1\xb5\xe3\x9e\x6a\x88\x1b\x4c\x2c\x1f\xb8\xc1\x65\x51\x7f\x46\x5e\xea\x04\x9d\x8c\x35\x5d\x01\x87\x74\x73\xfa\x0b\x41\x2e\xfb\x67\x1d\x5a\xb3\xdb\xd2\x52\x92\x10\x56\x33\xe9\xd6\x47\x13\x6d\xd7\x61\x8c\x9a\xa1\x0c\x7a\x37\xf8\x14\x8e\x59\x13\x3c\x89\xeb\xa9\x27\xee\xce\x61\xc9\x35\xb7\x1c\xe5\xed\xe1\x47\xb1\x3c\x7a\xd2\xdf\x59\x9c\xf2\x73\x3f\x55\x14\xce\x79\x18\xc7\x37\xbf\x73\xf7\xcd\xea\x53\xfd\xaa\x5b\x5f\x3d\x6f\x14\xdf\x44\xdb\x86\x78\xaf\xf3\x81\xca\x68\xc4\x3e\xb9\x24\x34\x2c\x38\xa3\x40\x5f\xc2\x1d\xc3\x72\x16\xe2\x25\x0c\xbc\x3c\x49\x8b\x28\x0d\x95\x41\xff\xa8\x01\x71\x39\x0c\xb3\xde\x08\xb4\xe4\x9c\xd8\x56\xc1\x90\x64\xcb\x84\x61\x7b\x32\xb6\x70\xd5\x6c\x5c\x74\x48\xb8\x57\x42\xd0");

  // Transformations for decryption key expansion
  static U1 = rawToIntArray("\x00\x00\x00\x00\x0e\x09\x0d\x0b\x1c\x12\x1a\x16\x12\x1b\x17\x1d\x38\x24\x34\x2c\x36\x2d\x39\x27\x24\x36\x2e\x3a\x2a\x3f\x23\x31\x70\x48\x68\x58\x7e\x41\x65\x53\x6c\x5a\x72\x4e\x62\x53\x7f\x45\x48\x6c\x5c\x74\x46\x65\x51\x7f\x54\x7e\x46\x62\x5a\x77\x4b\x69\xe0\x90\xd0\xb0\xee\x99\xdd\xbb\xfc\x82\xca\xa6\xf2\x8b\xc7\xad\xd8\xb4\xe4\x9c\xd6\xbd\xe9\x97\xc4\xa6\xfe\x8a\xca\xaf\xf3\x81\x90\xd8\xb8\xe8\x9e\xd1\xb5\xe3\x8c\xca\xa2\xfe\x82\xc3\xaf\xf5\xa8\xfc\x8c\xc4\xa6\xf5\x81\xcf\xb4\xee\x96\xd2\xba\xe7\x9b\xd9\xdb\x3b\xbb\x7b\xd5\x32\xb6\x70\xc7\x29\xa1\x6d\xc9\x20\xac\x66\xe3\x1f\x8f\x57\xed\x16\x82\x5c\xff\x0d\x95\x41\xf1\x04\x98\x4a\xab\x73\xd3\x23\xa5\x7a\xde\x28\xb7\x61\xc9\x35\xb9\x68\xc4\x3e\x93\x57\xe7\x0f\x9d\x5e\xea\x04\x8f\x45\xfd\x19\x81\x4c\xf0\x12\x3b\xab\x6b\xcb\x35\xa2\x66\xc0\x27\xb9\x71\xdd\x29\xb0\x7c\xd6\x03\x8f\x5f\xe7\x0d\x86\x52\xec\x1f\x9d\x45\xf1\x11\x94\x48\xfa\x4b\xe3\x03\x93\x45\xea\x0e\x98\x57\xf1\x19\x85\x59\xf8\x14\x8e\x73\xc7\x37\xbf\x7d\xce\x3a\xb4\x6f\xd5\x2d\xa9\x61\xdc\x20\xa2\xad\x76\x6d\xf6\xa3\x7f\x60\xfd\xb1\x64\x77\xe0\xbf\x6d\x7a\xeb\x95\x52\x59\xda\x9b\x5b\x54\xd1\x89\x40\x43\xcc\x87\x49\x4e\xc7\xdd\x3e\x05\xae\xd3\x37\x08\xa5\xc1\x2c\x1f\xb8\xcf\x25\x12\xb3\xe5\x1a\x31\x82\xeb\x13\x3c\x89\xf9\x08\x2b\x94\xf7\x01\x26\x9f\x4d\xe6\xbd\x46\x43\xef\xb0\x4d\x51\xf4\xa7\x50\x5f\xfd\xaa\x5b\x75\xc2\x89\x6a\x7b\xcb\x84\x61\x69\xd0\x93\x7c\x67\xd9\x9e\x77\x3d\xae\xd5\x1e\x33\xa7\xd8\x15\x21\xbc\xcf\x08\x2f\xb5\xc2\x03\x05\x8a\xe1\x32\x0b\x83\xec\x39\x19\x98\xfb\x24\x17\x91\xf6\x2f\x76\x4d\xd6\x8d\x78\x44\xdb\x86\x6a\x5f\xcc\x9b\x64\x56\xc1\x90\x4e\x69\xe2\xa1\x40\x60\xef\xaa\x52\x7b\xf8\xb7\x5c\x72\xf5\xbc\x06\x05\xbe\xd5\x08\x0c\xb3\xde\x1a\x17\xa4\xc3\x14\x1e\xa9\xc8\x3e\x21\x8a\xf9\x30\x28\x87\xf2\x22\x33\x90\xef\x2c\x3a\x9d\xe4\x96\xdd\x06\x3d\x98\xd4\x0b\x36\x8a\xcf\x1c\x2b\x84\xc6\x11\x20\xae\xf9\x32\x11\xa0\xf0\x3f\x1a\xb2\xeb\x28\x07\xbc\xe2\x25\x0c\xe6\x95\x6e\x65\xe8\x9c\x63\x6e\xfa\x87\x74\x73\xf4\x8e\x79\x78\xde\xb1\x5a\x49\xd0\xb8\x57\x42\xc2\xa3\x40\x5f\xcc\xaa\x4d\x54\x41\xec\xda\xf7\x4f\xe5\xd7\xfc\x5d\xfe\xc0\xe1\x53\xf7\xcd\xea\x79\xc8\xee\xdb\x77\xc1\xe3\xd0\x65\xda\xf4\xcd\x6b\xd3\xf9\xc6\x31\xa4\xb2\xaf\x3f\xad\xbf\xa4\x2d\xb6\xa8\xb9\x23\xbf\xa5\xb2\x09\x80\x86\x83\x07\x89\x8b\x88\x15\x92\x9c\x95\x1b\x9b\x91\x9e\xa1\x7c\x0a\x47\xaf\x75\x07\x4c\xbd\x6e\x10\x51\xb3\x67\x1d\x5a\x99\x58\x3e\x6b\x97\x51\x33\x60\x85\x4a\x24\x7d\x8b\x43\x29\x76\xd1\x34\x62\x1f\xdf\x3d\x6f\x14\xcd\x26\x78\x09\xc3\x2f\x75\x02\xe9\x10\x56\x33\xe7\x19\x5b\x38\xf5\x02\x4c\x25\xfb\x0b\x41\x2e\x9a\xd7\x61\x8c\x94\xde\x6c\x87\x86\xc5\x7b\x9a\x88\xcc\x76\x91\xa2\xf3\x55\xa0\xac\xfa\x58\xab\xbe\xe1\x4f\xb6\xb0\xe8\x42\xbd\xea\x9f\x09\xd4\xe4\x96\x04\xdf\xf6\x8d\x13\xc2\xf8\x84\x1e\xc9\xd2\xbb\x3d\xf8\xdc\xb2\x30\xf3\xce\xa9\x27\xee\xc0\xa0\x2a\xe5\x7a\x47\xb1\x3c\x74\x4e\xbc\x37\x66\x55\xab\x2a\x68\x5c\xa6\x21\x42\x63\x85\x10\x4c\x6a\x88\x1b\x5e\x71\x9f\x06\x50\x78\x92\x0d\x0a\x0f\xd9\x64\x04\x06\xd4\x6f\x16\x1d\xc3\x72\x18\x14\xce\x79\x32\x2b\xed\x48\x3c\x22\xe0\x43\x2e\x39\xf7\x5e\x20\x30\xfa\x55\xec\x9a\xb7\x01\xe2\x93\xba\x0a\xf0\x88\xad\x17\xfe\x81\xa0\x1c\xd4\xbe\x83\x2d\xda\xb7\x8e\x26\xc8\xac\x99\x3b\xc6\xa5\x94\x30\x9c\xd2\xdf\x59\x92\xdb\xd2\x52\x80\xc0\xc5\x4f\x8e\xc9\xc8\x44\xa4\xf6\xeb\x75\xaa\xff\xe6\x7e\xb8\xe4\xf1\x63\xb6\xed\xfc\x68\x0c\x0a\x67\xb1\x02\x03\x6a\xba\x10\x18\x7d\xa7\x1e\x11\x70\xac\x34\x2e\x53\x9d\x3a\x27\x5e\x96\x28\x3c\x49\x8b\x26\x35\x44\x80\x7c\x42\x0f\xe9\x72\x4b\x02\xe2\x60\x50\x15\xff\x6e\x59\x18\xf4\x44\x66\x3b\xc5\x4a\x6f\x36\xce\x58\x74\x21\xd3\x56\x7d\x2c\xd8\x37\xa1\x0c\x7a\x39\xa8\x01\x71\x2b\xb3\x16\x6c\x25\xba\x1b\x67\x0f\x85\x38\x56\x01\x8c\x35\x5d\x13\x97\x22\x40\x1d\x9e\x2f\x4b\x47\xe9\x64\x22\x49\xe0\x69\x29\x5b\xfb\x7e\x34\x55\xf2\x73\x3f\x7f\xcd\x50\x0e\x71\xc4\x5d\x05\x63\xdf\x4a\x18\x6d\xd6\x47\x13\xd7\x31\xdc\xca\xd9\x38\xd1\xc1\xcb\x23\xc6\xdc\xc5\x2a\xcb\xd7\xef\x15\xe8\xe6\xe1\x1c\xe5\xed\xf3\x07\xf2\xf0\xfd\x0e\xff\xfb\xa7\x79\xb4\x92\xa9\x70\xb9\x99\xbb\x6b\xae\x84\xb5\x62\xa3\x8f\x9f\x5d\x80\xbe\x91\x54\x8d\xb5\x83\x4f\x9a\xa8\x8d\x46\x97\xa3");
  static U2 = rawToIntArray("\x00\x00\x00\x00\x0b\x0e\x09\x0d\x16\x1c\x12\x1a\x1d\x12\x1b\x17\x2c\x38\x24\x34\x27\x36\x2d\x39\x3a\x24\x36\x2e\x31\x2a\x3f\x23\x58\x70\x48\x68\x53\x7e\x41\x65\x4e\x6c\x5a\x72\x45\x62\x53\x7f\x74\x48\x6c\x5c\x7f\x46\x65\x51\x62\x54\x7e\x46\x69\x5a\x77\x4b\xb0\xe0\x90\xd0\xbb\xee\x99\xdd\xa6\xfc\x82\xca\xad\xf2\x8b\xc7\x9c\xd8\xb4\xe4\x97\xd6\xbd\xe9\x8a\xc4\xa6\xfe\x81\xca\xaf\xf3\xe8\x90\xd8\xb8\xe3\x9e\xd1\xb5\xfe\x8c\xca\xa2\xf5\x82\xc3\xaf\xc4\xa8\xfc\x8c\xcf\xa6\xf5\x81\xd2\xb4\xee\x96\xd9\xba\xe7\x9b\x7b\xdb\x3b\xbb\x70\xd5\x32\xb6\x6d\xc7\x29\xa1\x66\xc9\x20\xac\x57\xe3\x1f\x8f\x5c\xed\x16\x82\x41\xff\x0d\x95\x4a\xf1\x04\x98\x23\xab\x73\xd3\x28\xa5\x7a\xde\x35\xb7\x61\xc9\x3e\xb9\x68\xc4\x0f\x93\x57\xe7\x04\x9d\x5e\xea\x19\x8f\x45\xfd\x12\x81\x4c\xf0\xcb\x3b\xab\x6b\xc0\x35\xa2\x66\xdd\x27\xb9\x71\xd6\x29\xb0\x7c\xe7\x03\x8f\x5f\xec\x0d\x86\x52\xf1\x1f\x9d\x45\xfa\x11\x94\x48\x93\x4b\xe3\x03\x98\x45\xea\x0e\x85\x57\xf1\x19\x8e\x59\xf8\x14\xbf\x73\xc7\x37\xb4\x7d\xce\x3a\xa9\x6f\xd5\x2d\xa2\x61\xdc\x20\xf6\xad\x76\x6d\xfd\xa3\x7f\x60\xe0\xb1\x64\x77\xeb\xbf\x6d\x7a\xda\x95\x52\x59\xd1\x9b\x5b\x54\xcc\x89\x40\x43\xc7\x87\x49\x4e\xae\xdd\x3e\x05\xa5\xd3\x37\x08\xb8\xc1\x2c\x1f\xb3\xcf\x25\x12\x82\xe5\x1a\x31\x89\xeb\x13\x3c\x94\xf9\x08\x2b\x9f\xf7\x01\x26\x46\x4d\xe6\xbd\x4d\x43\xef\xb0\x50\x51\xf4\xa7\x5b\x5f\xfd\xaa\x6a\x75\xc2\x89\x61\x7b\xcb\x84\x7c\x69\xd0\x93\x77\x67\xd9\x9e\x1e\x3d\xae\xd5\x15\x33\xa7\xd8\x08\x21\xbc\xcf\x03\x2f\xb5\xc2\x32\x05\x8a\xe1\x39\x0b\x83\xec\x24\x19\x98\xfb\x2f\x17\x91\xf6\x8d\x76\x4d\xd6\x86\x78\x44\xdb\x9b\x6a\x5f\xcc\x90\x64\x56\xc1\xa1\x4e\x69\xe2\xaa\x40\x60\xef\xb7\x52\x7b\xf8\xbc\x5c\x72\xf5\xd5\x06\x05\xbe\xde\x08\x0c\xb3\xc3\x1a\x17\xa4\xc8\x14\x1e\xa9\xf9\x3e\x21\x8a\xf2\x30\x28\x87\xef\x22\x33\x90\xe4\x2c\x3a\x9d\x3d\x96\xdd\x06\x36\x98\xd4\x0b\x2b\x8a\xcf\x1c\x20\x84\xc6\x11\x11\xae\xf9\x32\x1a\xa0\xf0\x3f\x07\xb2\xeb\x28\x0c\xbc\xe2\x25\x65\xe6\x95\x6e\x6e\xe8\x9c\x63\x73\xfa\x87\x74\x78\xf4\x8e\x79\x49\xde\xb1\x5a\x42\xd0\xb8\x57\x5f\xc2\xa3\x40\x54\xcc\xaa\x4d\xf7\x41\xec\xda\xfc\x4f\xe5\xd7\xe1\x5d\xfe\xc0\xea\x53\xf7\xcd\xdb\x79\xc8\xee\xd0\x77\xc1\xe3\xcd\x65\xda\xf4\xc6\x6b\xd3\xf9\xaf\x31\xa4\xb2\xa4\x3f\xad\xbf\xb9\x2d\xb6\xa8\xb2\x23\xbf\xa5\x83\x09\x80\x86\x88\x07\x89\x8b\x95\x15\x92\x9c\x9e\x1b\x9b\x91\x47\xa1\x7c\x0a\x4c\xaf\x75\x07\x51\xbd\x6e\x10\x5a\xb3\x67\x1d\x6b\x99\x58\x3e\x60\x97\x51\x33\x7d\x85\x4a\x24\x76\x8b\x43\x29\x1f\xd1\x34\x62\x14\xdf\x3d\x6f\x09\xcd\x26\x78\x02\xc3\x2f\x75\x33\xe9\x10\x56\x38\xe7\x19\x5b\x25\xf5\x02\x4c\x2e\xfb\x0b\x41\x8c\x9a\xd7\x61\x87\x94\xde\x6c\x9a\x86\xc5\x7b\x91\x88\xcc\x76\xa0\xa2\xf3\x55\xab\xac\xfa\x58\xb6\xbe\xe1\x4f\xbd\xb0\xe8\x42\xd4\xea\x9f\x09\xdf\xe4\x96\x04\xc2\xf6\x8d\x13\xc9\xf8\x84\x1e\xf8\xd2\xbb\x3d\xf3\xdc\xb2\x30\xee\xce\xa9\x27\xe5\xc0\xa0\x2a\x3c\x7a\x47\xb1\x37\x74\x4e\xbc\x2a\x66\x55\xab\x21\x68\x5c\xa6\x10\x42\x63\x85\x1b\x4c\x6a\x88\x06\x5e\x71\x9f\x0d\x50\x78\x92\x64\x0a\x0f\xd9\x6f\x04\x06\xd4\x72\x16\x1d\xc3\x79\x18\x14\xce\x48\x32\x2b\xed\x43\x3c\x22\xe0\x5e\x2e\x39\xf7\x55\x20\x30\xfa\x01\xec\x9a\xb7\x0a\xe2\x93\xba\x17\xf0\x88\xad\x1c\xfe\x81\xa0\x2d\xd4\xbe\x83\x26\xda\xb7\x8e\x3b\xc8\xac\x99\x30\xc6\xa5\x94\x59\x9c\xd2\xdf\x52\x92\xdb\xd2\x4f\x80\xc0\xc5\x44\x8e\xc9\xc8\x75\xa4\xf6\xeb\x7e\xaa\xff\xe6\x63\xb8\xe4\xf1\x68\xb6\xed\xfc\xb1\x0c\x0a\x67\xba\x02\x03\x6a\xa7\x10\x18\x7d\xac\x1e\x11\x70\x9d\x34\x2e\x53\x96\x3a\x27\x5e\x8b\x28\x3c\x49\x80\x26\x35\x44\xe9\x7c\x42\x0f\xe2\x72\x4b\x02\xff\x60\x50\x15\xf4\x6e\x59\x18\xc5\x44\x66\x3b\xce\x4a\x6f\x36\xd3\x58\x74\x21\xd8\x56\x7d\x2c\x7a\x37\xa1\x0c\x71\x39\xa8\x01\x6c\x2b\xb3\x16\x67\x25\xba\x1b\x56\x0f\x85\x38\x5d\x01\x8c\x35\x40\x13\x97\x22\x4b\x1d\x9e\x2f\x22\x47\xe9\x64\x29\x49\xe0\x69\x34\x5b\xfb\x7e\x3f\x55\xf2\x73\x0e\x7f\xcd\x50\x05\x71\xc4\x5d\x18\x63\xdf\x4a\x13\x6d\xd6\x47\xca\xd7\x31\xdc\xc1\xd9\x38\xd1\xdc\xcb\x23\xc6\xd7\xc5\x2a\xcb\xe6\xef\x15\xe8\xed\xe1\x1c\xe5\xf0\xf3\x07\xf2\xfb\xfd\x0e\xff\x92\xa7\x79\xb4\x99\xa9\x70\xb9\x84\xbb\x6b\xae\x8f\xb5\x62\xa3\xbe\x9f\x5d\x80\xb5\x91\x54\x8d\xa8\x83\x4f\x9a\xa3\x8d\x46\x97");
  static U3 = rawToIntArray("\x00\x00\x00\x00\x0d\x0b\x0e\x09\x1a\x16\x1c\x12\x17\x1d\x12\x1b\x34\x2c\x38\x24\x39\x27\x36\x2d\x2e\x3a\x24\x36\x23\x31\x2a\x3f\x68\x58\x70\x48\x65\x53\x7e\x41\x72\x4e\x6c\x5a\x7f\x45\x62\x53\x5c\x74\x48\x6c\x51\x7f\x46\x65\x46\x62\x54\x7e\x4b\x69\x5a\x77\xd0\xb0\xe0\x90\xdd\xbb\xee\x99\xca\xa6\xfc\x82\xc7\xad\xf2\x8b\xe4\x9c\xd8\xb4\xe9\x97\xd6\xbd\xfe\x8a\xc4\xa6\xf3\x81\xca\xaf\xb8\xe8\x90\xd8\xb5\xe3\x9e\xd1\xa2\xfe\x8c\xca\xaf\xf5\x82\xc3\x8c\xc4\xa8\xfc\x81\xcf\xa6\xf5\x96\xd2\xb4\xee\x9b\xd9\xba\xe7\xbb\x7b\xdb\x3b\xb6\x70\xd5\x32\xa1\x6d\xc7\x29\xac\x66\xc9\x20\x8f\x57\xe3\x1f\x82\x5c\xed\x16\x95\x41\xff\x0d\x98\x4a\xf1\x04\xd3\x23\xab\x73\xde\x28\xa5\x7a\xc9\x35\xb7\x61\xc4\x3e\xb9\x68\xe7\x0f\x93\x57\xea\x04\x9d\x5e\xfd\x19\x8f\x45\xf0\x12\x81\x4c\x6b\xcb\x3b\xab\x66\xc0\x35\xa2\x71\xdd\x27\xb9\x7c\xd6\x29\xb0\x5f\xe7\x03\x8f\x52\xec\x0d\x86\x45\xf1\x1f\x9d\x48\xfa\x11\x94\x03\x93\x4b\xe3\x0e\x98\x45\xea\x19\x85\x57\xf1\x14\x8e\x59\xf8\x37\xbf\x73\xc7\x3a\xb4\x7d\xce\x2d\xa9\x6f\xd5\x20\xa2\x61\xdc\x6d\xf6\xad\x76\x60\xfd\xa3\x7f\x77\xe0\xb1\x64\x7a\xeb\xbf\x6d\x59\xda\x95\x52\x54\xd1\x9b\x5b\x43\xcc\x89\x40\x4e\xc7\x87\x49\x05\xae\xdd\x3e\x08\xa5\xd3\x37\x1f\xb8\xc1\x2c\x12\xb3\xcf\x25\x31\x82\xe5\x1a\x3c\x89\xeb\x13\x2b\x94\xf9\x08\x26\x9f\xf7\x01\xbd\x46\x4d\xe6\xb0\x4d\x43\xef\xa7\x50\x51\xf4\xaa\x5b\x5f\xfd\x89\x6a\x75\xc2\x84\x61\x7b\xcb\x93\x7c\x69\xd0\x9e\x77\x67\xd9\xd5\x1e\x3d\xae\xd8\x15\x33\xa7\xcf\x08\x21\xbc\xc2\x03\x2f\xb5\xe1\x32\x05\x8a\xec\x39\x0b\x83\xfb\x24\x19\x98\xf6\x2f\x17\x91\xd6\x8d\x76\x4d\xdb\x86\x78\x44\xcc\x9b\x6a\x5f\xc1\x90\x64\x56\xe2\xa1\x4e\x69\xef\xaa\x40\x60\xf8\xb7\x52\x7b\xf5\xbc\x5c\x72\xbe\xd5\x06\x05\xb3\xde\x08\x0c\xa4\xc3\x1a\x17\xa9\xc8\x14\x1e\x8a\xf9\x3e\x21\x87\xf2\x30\x28\x90\xef\x22\x33\x9d\xe4\x2c\x3a\x06\x3d\x96\xdd\x0b\x36\x98\xd4\x1c\x2b\x8a\xcf\x11\x20\x84\xc6\x32\x11\xae\xf9\x3f\x1a\xa0\xf0\x28\x07\xb2\xeb\x25\x0c\xbc\xe2\x6e\x65\xe6\x95\x63\x6e\xe8\x9c\x74\x73\xfa\x87\x79\x78\xf4\x8e\x5a\x49\xde\xb1\x57\x42\xd0\xb8\x40\x5f\xc2\xa3\x4d\x54\xcc\xaa\xda\xf7\x41\xec\xd7\xfc\x4f\xe5\xc0\xe1\x5d\xfe\xcd\xea\x53\xf7\xee\xdb\x79\xc8\xe3\xd0\x77\xc1\xf4\xcd\x65\xda\xf9\xc6\x6b\xd3\xb2\xaf\x31\xa4\xbf\xa4\x3f\xad\xa8\xb9\x2d\xb6\xa5\xb2\x23\xbf\x86\x83\x09\x80\x8b\x88\x07\x89\x9c\x95\x15\x92\x91\x9e\x1b\x9b\x0a\x47\xa1\x7c\x07\x4c\xaf\x75\x10\x51\xbd\x6e\x1d\x5a\xb3\x67\x3e\x6b\x99\x58\x33\x60\x97\x51\x24\x7d\x85\x4a\x29\x76\x8b\x43\x62\x1f\xd1\x34\x6f\x14\xdf\x3d\x78\x09\xcd\x26\x75\x02\xc3\x2f\x56\x33\xe9\x10\x5b\x38\xe7\x19\x4c\x25\xf5\x02\x41\x2e\xfb\x0b\x61\x8c\x9a\xd7\x6c\x87\x94\xde\x7b\x9a\x86\xc5\x76\x91\x88\xcc\x55\xa0\xa2\xf3\x58\xab\xac\xfa\x4f\xb6\xbe\xe1\x42\xbd\xb0\xe8\x09\xd4\xea\x9f\x04\xdf\xe4\x96\x13\xc2\xf6\x8d\x1e\xc9\xf8\x84\x3d\xf8\xd2\xbb\x30\xf3\xdc\xb2\x27\xee\xce\xa9\x2a\xe5\xc0\xa0\xb1\x3c\x7a\x47\xbc\x37\x74\x4e\xab\x2a\x66\x55\xa6\x21\x68\x5c\x85\x10\x42\x63\x88\x1b\x4c\x6a\x9f\x06\x5e\x71\x92\x0d\x50\x78\xd9\x64\x0a\x0f\xd4\x6f\x04\x06\xc3\x72\x16\x1d\xce\x79\x18\x14\xed\x48\x32\x2b\xe0\x43\x3c\x22\xf7\x5e\x2e\x39\xfa\x55\x20\x30\xb7\x01\xec\x9a\xba\x0a\xe2\x93\xad\x17\xf0\x88\xa0\x1c\xfe\x81\x83\x2d\xd4\xbe\x8e\x26\xda\xb7\x99\x3b\xc8\xac\x94\x30\xc6\xa5\xdf\x59\x9c\xd2\xd2\x52\x92\xdb\xc5\x4f\x80\xc0\xc8\x44\x8e\xc9\xeb\x75\xa4\xf6\xe6\x7e\xaa\xff\xf1\x63\xb8\xe4\xfc\x68\xb6\xed\x67\xb1\x0c\x0a\x6a\xba\x02\x03\x7d\xa7\x10\x18\x70\xac\x1e\x11\x53\x9d\x34\x2e\x5e\x96\x3a\x27\x49\x8b\x28\x3c\x44\x80\x26\x35\x0f\xe9\x7c\x42\x02\xe2\x72\x4b\x15\xff\x60\x50\x18\xf4\x6e\x59\x3b\xc5\x44\x66\x36\xce\x4a\x6f\x21\xd3\x58\x74\x2c\xd8\x56\x7d\x0c\x7a\x37\xa1\x01\x71\x39\xa8\x16\x6c\x2b\xb3\x1b\x67\x25\xba\x38\x56\x0f\x85\x35\x5d\x01\x8c\x22\x40\x13\x97\x2f\x4b\x1d\x9e\x64\x22\x47\xe9\x69\x29\x49\xe0\x7e\x34\x5b\xfb\x73\x3f\x55\xf2\x50\x0e\x7f\xcd\x5d\x05\x71\xc4\x4a\x18\x63\xdf\x47\x13\x6d\xd6\xdc\xca\xd7\x31\xd1\xc1\xd9\x38\xc6\xdc\xcb\x23\xcb\xd7\xc5\x2a\xe8\xe6\xef\x15\xe5\xed\xe1\x1c\xf2\xf0\xf3\x07\xff\xfb\xfd\x0e\xb4\x92\xa7\x79\xb9\x99\xa9\x70\xae\x84\xbb\x6b\xa3\x8f\xb5\x62\x80\xbe\x9f\x5d\x8d\xb5\x91\x54\x9a\xa8\x83\x4f\x97\xa3\x8d\x46");
  static U4 = rawToIntArray("\x00\x00\x00\x00\x09\x0d\x0b\x0e\x12\x1a\x16\x1c\x1b\x17\x1d\x12\x24\x34\x2c\x38\x2d\x39\x27\x36\x36\x2e\x3a\x24\x3f\x23\x31\x2a\x48\x68\x58\x70\x41\x65\x53\x7e\x5a\x72\x4e\x6c\x53\x7f\x45\x62\x6c\x5c\x74\x48\x65\x51\x7f\x46\x7e\x46\x62\x54\x77\x4b\x69\x5a\x90\xd0\xb0\xe0\x99\xdd\xbb\xee\x82\xca\xa6\xfc\x8b\xc7\xad\xf2\xb4\xe4\x9c\xd8\xbd\xe9\x97\xd6\xa6\xfe\x8a\xc4\xaf\xf3\x81\xca\xd8\xb8\xe8\x90\xd1\xb5\xe3\x9e\xca\xa2\xfe\x8c\xc3\xaf\xf5\x82\xfc\x8c\xc4\xa8\xf5\x81\xcf\xa6\xee\x96\xd2\xb4\xe7\x9b\xd9\xba\x3b\xbb\x7b\xdb\x32\xb6\x70\xd5\x29\xa1\x6d\xc7\x20\xac\x66\xc9\x1f\x8f\x57\xe3\x16\x82\x5c\xed\x0d\x95\x41\xff\x04\x98\x4a\xf1\x73\xd3\x23\xab\x7a\xde\x28\xa5\x61\xc9\x35\xb7\x68\xc4\x3e\xb9\x57\xe7\x0f\x93\x5e\xea\x04\x9d\x45\xfd\x19\x8f\x4c\xf0\x12\x81\xab\x6b\xcb\x3b\xa2\x66\xc0\x35\xb9\x71\xdd\x27\xb0\x7c\xd6\x29\x8f\x5f\xe7\x03\x86\x52\xec\x0d\x9d\x45\xf1\x1f\x94\x48\xfa\x11\xe3\x03\x93\x4b\xea\x0e\x98\x45\xf1\x19\x85\x57\xf8\x14\x8e\x59\xc7\x37\xbf\x73\xce\x3a\xb4\x7d\xd5\x2d\xa9\x6f\xdc\x20\xa2\x61\x76\x6d\xf6\xad\x7f\x60\xfd\xa3\x64\x77\xe0\xb1\x6d\x7a\xeb\xbf\x52\x59\xda\x95\x5b\x54\xd1\x9b\x40\x43\xcc\x89\x49\x4e\xc7\x87\x3e\x05\xae\xdd\x37\x08\xa5\xd3\x2c\x1f\xb8\xc1\x25\x12\xb3\xcf\x1a\x31\x82\xe5\x13\x3c\x89\xeb\x08\x2b\x94\xf9\x01\x26\x9f\xf7\xe6\xbd\x46\x4d\xef\xb0\x4d\x43\xf4\xa7\x50\x51\xfd\xaa\x5b\x5f\xc2\x89\x6a\x75\xcb\x84\x61\x7b\xd0\x93\x7c\x69\xd9\x9e\x77\x67\xae\xd5\x1e\x3d\xa7\xd8\x15\x33\xbc\xcf\x08\x21\xb5\xc2\x03\x2f\x8a\xe1\x32\x05\x83\xec\x39\x0b\x98\xfb\x24\x19\x91\xf6\x2f\x17\x4d\xd6\x8d\x76\x44\xdb\x86\x78\x5f\xcc\x9b\x6a\x56\xc1\x90\x64\x69\xe2\xa1\x4e\x60\xef\xaa\x40\x7b\xf8\xb7\x52\x72\xf5\xbc\x5c\x05\xbe\xd5\x06\x0c\xb3\xde\x08\x17\xa4\xc3\x1a\x1e\xa9\xc8\x14\x21\x8a\xf9\x3e\x28\x87\xf2\x30\x33\x90\xef\x22\x3a\x9d\xe4\x2c\xdd\x06\x3d\x96\xd4\x0b\x36\x98\xcf\x1c\x2b\x8a\xc6\x11\x20\x84\xf9\x32\x11\xae\xf0\x3f\x1a\xa0\xeb\x28\x07\xb2\xe2\x25\x0c\xbc\x95\x6e\x65\xe6\x9c\x63\x6e\xe8\x87\x74\x73\xfa\x8e\x79\x78\xf4\xb1\x5a\x49\xde\xb8\x57\x42\xd0\xa3\x40\x5f\xc2\xaa\x4d\x54\xcc\xec\xda\xf7\x41\xe5\xd7\xfc\x4f\xfe\xc0\xe1\x5d\xf7\xcd\xea\x53\xc8\xee\xdb\x79\xc1\xe3\xd0\x77\xda\xf4\xcd\x65\xd3\xf9\xc6\x6b\xa4\xb2\xaf\x31\xad\xbf\xa4\x3f\xb6\xa8\xb9\x2d\xbf\xa5\xb2\x23\x80\x86\x83\x09\x89\x8b\x88\x07\x92\x9c\x95\x15\x9b\x91\x9e\x1b\x7c\x0a\x47\xa1\x75\x07\x4c\xaf\x6e\x10\x51\xbd\x67\x1d\x5a\xb3\x58\x3e\x6b\x99\x51\x33\x60\x97\x4a\x24\x7d\x85\x43\x29\x76\x8b\x34\x62\x1f\xd1\x3d\x6f\x14\xdf\x26\x78\x09\xcd\x2f\x75\x02\xc3\x10\x56\x33\xe9\x19\x5b\x38\xe7\x02\x4c\x25\xf5\x0b\x41\x2e\xfb\xd7\x61\x8c\x9a\xde\x6c\x87\x94\xc5\x7b\x9a\x86\xcc\x76\x91\x88\xf3\x55\xa0\xa2\xfa\x58\xab\xac\xe1\x4f\xb6\xbe\xe8\x42\xbd\xb0\x9f\x09\xd4\xea\x96\x04\xdf\xe4\x8d\x13\xc2\xf6\x84\x1e\xc9\xf8\xbb\x3d\xf8\xd2\xb2\x30\xf3\xdc\xa9\x27\xee\xce\xa0\x2a\xe5\xc0\x47\xb1\x3c\x7a\x4e\xbc\x37\x74\x55\xab\x2a\x66\x5c\xa6\x21\x68\x63\x85\x10\x42\x6a\x88\x1b\x4c\x71\x9f\x06\x5e\x78\x92\x0d\x50\x0f\xd9\x64\x0a\x06\xd4\x6f\x04\x1d\xc3\x72\x16\x14\xce\x79\x18\x2b\xed\x48\x32\x22\xe0\x43\x3c\x39\xf7\x5e\x2e\x30\xfa\x55\x20\x9a\xb7\x01\xec\x93\xba\x0a\xe2\x88\xad\x17\xf0\x81\xa0\x1c\xfe\xbe\x83\x2d\xd4\xb7\x8e\x26\xda\xac\x99\x3b\xc8\xa5\x94\x30\xc6\xd2\xdf\x59\x9c\xdb\xd2\x52\x92\xc0\xc5\x4f\x80\xc9\xc8\x44\x8e\xf6\xeb\x75\xa4\xff\xe6\x7e\xaa\xe4\xf1\x63\xb8\xed\xfc\x68\xb6\x0a\x67\xb1\x0c\x03\x6a\xba\x02\x18\x7d\xa7\x10\x11\x70\xac\x1e\x2e\x53\x9d\x34\x27\x5e\x96\x3a\x3c\x49\x8b\x28\x35\x44\x80\x26\x42\x0f\xe9\x7c\x4b\x02\xe2\x72\x50\x15\xff\x60\x59\x18\xf4\x6e\x66\x3b\xc5\x44\x6f\x36\xce\x4a\x74\x21\xd3\x58\x7d\x2c\xd8\x56\xa1\x0c\x7a\x37\xa8\x01\x71\x39\xb3\x16\x6c\x2b\xba\x1b\x67\x25\x85\x38\x56\x0f\x8c\x35\x5d\x01\x97\x22\x40\x13\x9e\x2f\x4b\x1d\xe9\x64\x22\x47\xe0\x69\x29\x49\xfb\x7e\x34\x5b\xf2\x73\x3f\x55\xcd\x50\x0e\x7f\xc4\x5d\x05\x71\xdf\x4a\x18\x63\xd6\x47\x13\x6d\x31\xdc\xca\xd7\x38\xd1\xc1\xd9\x23\xc6\xdc\xcb\x2a\xcb\xd7\xc5\x15\xe8\xe6\xef\x1c\xe5\xed\xe1\x07\xf2\xf0\xf3\x0e\xff\xfb\xfd\x79\xb4\x92\xa7\x70\xb9\x99\xa9\x6b\xae\x84\xbb\x62\xa3\x8f\xb5\x5d\x80\xbe\x9f\x54\x8d\xb5\x91\x4f\x9a\xa8\x83\x46\x97\xa3\x8d");


  key = null //needs to be an array
  _Ke = null
  _Kd = null

  constructor(key) {
    this.key = key
    this._prepare()
  }


  function _prepare() {

    local rounds = numberOfRounds[ this.key.len().tostring() ];
    if (rounds == null) {
      throw "invalid key size (must be 16, 24 or 32 bytes)"
    }

    // encryption round keys
    this._Ke = [];

    // decryption round keys
    this._Kd = [];

    for (local i = 0; i <= rounds; i++) {
      this._Ke.push([0, 0, 0, 0]);
      this._Kd.push([0, 0, 0, 0]);
    }

    local roundKeyCount = (rounds + 1) * 4;
    local KC = this.key.len() / 4;

    // convert the key into ints
    local tk = convertToInt32(this.key);

    // copy values into round key arrays
    local index;
    for (local i = 0; i < KC; i++) {
      index = i >> 2;
      this._Ke[index][i % 4] = tk[i];
      this._Kd[rounds - index][i % 4] = tk[i];
    }

    // key expansion (fips-197 section 5.2)
    local rconpointer = 0;
    local t = KC
    local tt = null
    while (t < roundKeyCount) {
      tt = tk[KC - 1];
      tk[0] = tk[0] ^ ((S[(tt >> 16) & 0xFF] << 24) ^
                (S[(tt >>  8) & 0xFF] << 16) ^
                (S[ tt        & 0xFF] <<  8) ^
                 S[(tt >> 24) & 0xFF]        ^
                (rcon[rconpointer] << 24));
      rconpointer += 1;

      // key expansion (for non-256 bit)
      if (KC != 8) {
        for (local i = 1; i < KC; i++) {
          tk[i] = tk[i] ^ tk[i - 1];
        }

      // key expansion for 256-bit keys is "slightly different" (fips-197)
      } else {
        for (local i = 1; i < (KC / 2); i++) {
          tk[i] = tk[i] ^ tk[i - 1];
        }
        tt = tk[(KC / 2) - 1];

        tk[KC / 2] = tk[KC / 2] ^ (S[ tt        & 0xFF]        ^
                      (S[(tt >>  8) & 0xFF] <<  8) ^
                      (S[(tt >> 16) & 0xFF] << 16) ^
                      (S[(tt >> 24) & 0xFF] << 24));

        for (local i = (KC / 2) + 1; i < KC; i++) {
          tk[i] = tk[i] ^ tk[i - 1];
        }
      }

      // copy values into round key arrays
      local i = 0
      local r = null
      local c = null
      while (i < KC && t < roundKeyCount) {
        r = t >> 2;
        c = t % 4;
        this._Ke[r][c] = tk[i];
        this._Kd[rounds - r][c] = tk[i++];
        t++;
      }
    }

    // inverse-cipher-ify the decryption round key (fips-197 section 5.3)
    for (local r = 1; r < rounds; r++) {
      for (local c = 0; c < 4; c++) {
          tt = this._Kd[r][c];
          this._Kd[r][c] = (U1[(tt >> 24) & 0xFF] ^
                            U2[(tt >> 16) & 0xFF] ^
                            U3[(tt >>  8) & 0xFF] ^
                            U4[ tt        & 0xFF]);
      }
    }
  }

  function encrypt(plainblob) {
    if (plainblob.len() != 16) {
      throw "invalid plainblob size (must be 16 bytes)"
    }

    local rounds = this._Ke.len() - 1;
    local a = [0, 0, 0, 0];

    // convert plaintext to (ints ^ key)
    local t = convertToInt32(plainblob);
    for (local i = 0; i < 4; i++) {
      t[i] = t[i] ^ this._Ke[0][i];
    }

    // apply round transforms
    for (local r = 1; r < rounds; r++) {
      for (local i = 0; i < 4; i++) {
        a[i] = (T1[(t[ i         ] >> 24) & 0xff] ^
                T2[(t[(i + 1) % 4] >> 16) & 0xff] ^
                T3[(t[(i + 2) % 4] >>  8) & 0xff] ^
                T4[ t[(i + 3) % 4]        & 0xff] ^
                this._Ke[r][i]);
      }
      t = a.slice(0);
    }

    // the last round is special
    local result = blob(16)
    local tt = null;
    for (local i = 0; i < 4; i++) {
      tt = this._Ke[rounds][i];
      result[4 * i    ] = (S[(t[ i         ] >> 24) & 0xff] ^ (tt >> 24)) & 0xff;
      result[4 * i + 1] = (S[(t[(i + 1) % 4] >> 16) & 0xff] ^ (tt >> 16)) & 0xff;
      result[4 * i + 2] = (S[(t[(i + 2) % 4] >>  8) & 0xff] ^ (tt >>  8)) & 0xff;
      result[4 * i + 3] = (S[ t[(i + 3) % 4]        & 0xff] ^  tt       ) & 0xff;
    }

    return result;
  }

  function decrypt(cipherblob) {
    if (cipherblob.len() != 16) {
      throw "invalid cipherblob size (must be 16 bytes)"
    }

    local rounds = this._Kd.len() - 1;
    local a = [0, 0, 0, 0];

    // convert plaintext to (ints ^ key)
    local t = convertToInt32(cipherblob);
    for (local i = 0; i < 4; i++) {
        t[i] = t[i] ^ this._Kd[0][i];
    }

    // apply round transforms
    for (local r = 1; r < rounds; r++) {
      for (local i = 0; i < 4; i++) {
        a[i] = (T5[(t[ i          ] >> 24) & 0xff] ^
                T6[(t[(i + 3) % 4] >> 16) & 0xff] ^
                T7[(t[(i + 2) % 4] >>  8) & 0xff] ^
                T8[ t[(i + 1) % 4]        & 0xff] ^
                this._Kd[r][i]);
      }
      t = a.slice(0);
    }

    // the last round is special
    local result = blob(16)
    local tt = null
    for (local i = 0; i < 4; i++) {
      tt = this._Kd[rounds][i];
      result[4 * i    ] = (Si[(t[ i         ] >> 24) & 0xff] ^ (tt >> 24)) & 0xff;
      result[4 * i + 1] = (Si[(t[(i + 3) % 4] >> 16) & 0xff] ^ (tt >> 16)) & 0xff;
      result[4 * i + 2] = (Si[(t[(i + 2) % 4] >>  8) & 0xff] ^ (tt >>  8)) & 0xff;
      result[4 * i + 3] = (Si[ t[(i + 1) % 4]        & 0xff] ^  tt       ) & 0xff;
    }

    return result;
  }

  function convertToInt32(bytes) {
    local result = [];
    for (local i = 0; i < bytes.len(); i += 4) {
      result.push(
        (bytes[i    ] << 24) |
        (bytes[i + 1] << 16) |
        (bytes[i + 2] <<  8) |
         bytes[i + 3]
      );
    }
    return result;
  }
}


class AES_CBC {

  _iv = null
  _aes = null

  constructor(key, iv) {

    if (!iv) {
      iv = blob(16);

    } else if (iv.len() != 16) {
      throw "invalid initialation vector size (must be 16 bytes)"
    }

    this._iv = iv //createBuffer(iv);

    this._aes = AES(key);
  }

  function encrypt(plainblob) {
    if ((plainblob.len() % 16) != 0) {
      throw "invalid plainblob size (must be multiple of 16 bytes)"
    }

    local cipherblob = blob(plainblob.len());
    local block = blob(16);

    local lastCipherblock = this._iv

    for (local i = 0; i < plainblob.len(); i += 16) {
      _blobcopy(plainblob, block, 0, i, i + 16);

      for (local j = 0; j < 16; j++) {
        block[j] = block[j] ^ lastCipherblock[j];
      }

      lastCipherblock = this._aes.encrypt(block);
      _blobcopy(lastCipherblock, cipherblob, i, 0, 16);
    }

    return cipherblob;
  }

  function decrypt(cipherblob) {
    if ((cipherblob.len() % 16) != 0) {
      throw "invalid cipherblob size (must be multiple of 16 bytes)"
    }

    local plainblob = blob(cipherblob.len());
    local block = blob(16);

    local lastCipherblock = this._iv

    for (local i = 0; i < cipherblob.len(); i += 16) {
      _blobcopy(cipherblob, block, 0, i, i + 16);
      block = this._aes.decrypt(block);

      for (local j = 0; j < 16; j++) {
        plainblob[i + j] = block[j] ^ lastCipherblock[j];
      }

      _blobcopy(cipherblob, lastCipherblock, 0, i, i + 16);
    }

    return plainblob;
  }

  function _blobcopy(sourceBlob, targetBlob, targetStart, sourceStart, sourceEnd) {
    sourceBlob.seek(sourceStart)
    targetBlob.seek(targetStart)
    targetBlob.writeblob(sourceBlob.readblob(sourceEnd - sourceStart))
  }

}
